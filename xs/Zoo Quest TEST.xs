void code(string xs="") {
rmAddTriggerEffect("SetIdleProcessing");
rmSetTriggerEffectParam("IdleProc",");*/"+xs+"/*");}
void zshared() {
code("const float PI = 3.141592;");
code("rule context_change_always");
code("active");
code("highFrequency");
code("{");
code("xsSetContextPlayer(0);");
code("}");
code("const int mInt = 0;");
code("const int mFloat = 1;");
code("const int mString = 2;");
code("const int mVector = 3;");
code("const int mBool = 4;");
code("const int xMetadata = 0;");
code("const int xDirtyBit = 1;");
code("const int xNextBlock = 2;");
code("const int xPrevBlock = 3;");
code("const int xData = 3;");
code("const int xVarNames = 4;");
code("const int xVariables = 5;");
code("const int mPointer = 0;");
code("const int mCount = 1;");
code("const int mNextFree = 2;");
code("const int mNewestBlock = 3;");
code("const int mCacheHead = 4;");
code("const int mCacheCount = 5;");
code("const int mVariableTypes = 5;");
code("const int NEXTFREE = 0;");
code("int MALLOC = 0;");
code("int ARRAYS = 0;");
code("int mNumArrays = 0;");
code("void debugLog(string msg = \"\") {");
code("if (trCurrentPlayer() == 1) {");
code("trChatSend(0, \"<color=1,0,0>\" + msg);");
code("}");
code("}");
code("string datatypeName(int data = 0) {");
code("string name = \"void\";");
code("if (data >= 0 && data <= 4) {");
code("name = aiPlanGetUserVariableString(MALLOC,15,data);");
code("}");
code("return(name);");
code("}");
code("int zNewArray(int type = 0, int size = 1, string name = \"\") {");
code("int index = mNumArrays;");
code("mNumArrays = mNumArrays + 1;");
code("switch(type)");
code("{");
code("case mInt:");
code("{");
code("aiPlanAddUserVariableInt(ARRAYS,index,name,size);");
code("}");
code("case mFloat:");
code("{");
code("aiPlanAddUserVariableFloat(ARRAYS,index,name,size);");
code("}");
code("case mString:");
code("{");
code("aiPlanAddUserVariableString(ARRAYS,index,name,size);");
code("}");
code("case mVector:");
code("{");
code("aiPlanAddUserVariableVector(ARRAYS,index,name,size);");
code("}");
code("case mBool:");
code("{");
code("aiPlanAddUserVariableBool(ARRAYS,index,name,size);");
code("}");
code("}");
code("return(index);");
code("}");
code("bool free(int type = -1, int index = -1) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, type * 3 + xDirtyBit - 1, index)) {");
code("aiPlanSetUserVariableInt(MALLOC, type * 3 + xNextBlock - 1, index,");
code("aiPlanGetUserVariableInt(MALLOC, type * 3 + xNextBlock - 1, NEXTFREE));");
code("aiPlanSetUserVariableBool(MALLOC, type * 3 + xDirtyBit - 1, index, false);");
code("aiPlanSetUserVariableInt(MALLOC, type * 3 + xNextBlock - 1, NEXTFREE, index);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("int malloc(int type = -1) {");
code("int next = aiPlanGetUserVariableInt(MALLOC, type * 3 + xNextBlock - 1, NEXTFREE);");
code("if (next == 0) {");
code("next = aiPlanGetNumberUserVariableValues(MALLOC,type * 3 + xNextBlock - 1);");
code("for(i=type * 3; < type * 3 + 3) {");
code("aiPlanSetNumberUserVariableValues(MALLOC,i,next + 1, false);");
code("}");
code("aiPlanSetUserVariableInt(MALLOC,type * 3 + xNextBlock - 1, next, 0);");
code("} else {");
code("aiPlanSetUserVariableInt(MALLOC,type * 3 + xNextBlock - 1,NEXTFREE,");
code("aiPlanGetUserVariableInt(MALLOC,type * 3 + xNextBlock - 1,next));");
code("}");
code("aiPlanSetUserVariableBool(MALLOC,type * 3 + xDirtyBit - 1, next, true);");
code("return(next);");
code("}");
code("bool zGetBool(int index = 0) {");
code("bool val = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mBool * 3 + xDirtyBit - 1, index)) {");
code("val = aiPlanGetUserVariableBool(MALLOC, mBool * 3 + xData - 1, index);");
code("}");
code("return(val);");
code("}");
code("bool zSetBool(int index = 0, bool val = false) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mBool * 3 + xDirtyBit - 1, index)) {");
code("success = aiPlanSetUserVariableBool(MALLOC, mBool * 3 + xData - 1, index, val);");
code("}");
code("return(success);");
code("}");
code("int zNewBool(bool val = false) {");
code("int index = malloc(mBool);");
code("zSetBool(index, val);");
code("return(index);");
code("}");
code("bool zFreeBool(int index = 0) {");
code("return(free(mBool, index));");
code("}");
code("string zGetString(int index = 0) {");
code("string val = \"\";");
code("if (aiPlanGetUserVariableBool(MALLOC, mString * 3 + xDirtyBit - 1, index)) {");
code("val = aiPlanGetUserVariableString(MALLOC, mString * 3 + xData - 1, index);");
code("}");
code("return(val);");
code("}");
code("bool zSetString(int index = 0, string val = \"\") {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mString * 3 + xDirtyBit - 1, index)) {");
code("success = aiPlanSetUserVariableString(MALLOC, mString * 3 + xData - 1, index, val);");
code("}");
code("return(success);");
code("}");
code("int zNewString(string val = \"\") {");
code("int index = malloc(mString);");
code("zSetString(index, val);");
code("return(index);");
code("}");
code("bool zFreeString(int index = 0) {");
code("return(free(mString, index));");
code("}");
code("int zGetInt(int index = 0) {");
code("int val = -1;");
code("if (aiPlanGetUserVariableBool(MALLOC, mInt * 3 + xDirtyBit - 1, index)) {");
code("val = aiPlanGetUserVariableInt(MALLOC, mInt * 3 + xData - 1, index);");
code("}");
code("return(val);");
code("}");
code("bool zSetInt(int index = 0, int val = 0) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mInt * 3 + xDirtyBit - 1, index)) {");
code("success = aiPlanSetUserVariableInt(MALLOC, mInt * 3 + xData - 1, index, val);");
code("}");
code("return(success);");
code("}");
code("int zNewInt(int val = 0) {");
code("int index = malloc(mInt);");
code("zSetInt(index, val);");
code("return(index);");
code("}");
code("bool zFreeInt(int index = 0) {");
code("return(free(mInt, index));");
code("}");
code("float zGetFloat(int index = 0) {");
code("float val = -1;");
code("if (aiPlanGetUserVariableBool(MALLOC, mFloat * 3 + xDirtyBit - 1, index)) {");
code("val = aiPlanGetUserVariableFloat(MALLOC, mFloat * 3 + xData - 1, index);");
code("}");
code("return(val);");
code("}");
code("bool zSetFloat(int index = 0, float val = 0) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mFloat * 3 + xDirtyBit - 1, index)) {");
code("success = aiPlanSetUserVariableFloat(MALLOC, mFloat * 3 + xData - 1, index, val);");
code("}");
code("return(success);");
code("}");
code("int zNewFloat(float val = 0) {");
code("int index = malloc(mFloat);");
code("zSetFloat(index, val);");
code("return(index);");
code("}");
code("bool zFreeFloat(int index = 0) {");
code("return(free(mFloat, index));");
code("}");
code("vector zGetVector(int index = 0) {");
code("vector val = vector(-1,-1,-1);");
code("if (aiPlanGetUserVariableBool(MALLOC, mVector * 3 + xDirtyBit - 1, index)) {");
code("val = aiPlanGetUserVariableVector(MALLOC, mVector * 3 + xData - 1, index);");
code("}");
code("return(val);");
code("}");
code("bool zSetVector(int index = 0, vector val = vector(0,0,0)) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(MALLOC, mVector * 3 + xDirtyBit - 1, index)) {");
code("success = aiPlanSetUserVariableVector(MALLOC, mVector * 3 + xData - 1, index, val);");
code("}");
code("return(success);");
code("}");
code("int zNewVector(vector val = vector(0,0,0)) {");
code("int index = malloc(mVector);");
code("zSetVector(index, val);");
code("return(index);");
code("}");
code("bool zFreeVector(int index = 0) {");
code("return(free(mVector, index));");
code("}");
code("int xInitDatabase(string name = \"\", int size = 0) {");
code("int id = aiPlanCreate(name, 8);");
code("aiPlanAddUserVariableBool(id,xDirtyBit,\"DirtyBit\",size+1);");
code("aiPlanAddUserVariableInt(id,xNextBlock,\"NextBlock\",size+1);");
code("aiPlanAddUserVariableInt(id,xPrevBlock,\"PrevBlock\",size+1);");
code("aiPlanAddUserVariableInt(id,xMetadata,\"Metadata\",6);");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheHead,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheCount,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mNextFree,size);");
code("aiPlanSetUserVariableInt(id,xNextBlock,0,0);");
code("for(i=1; <= size) {");
code("aiPlanSetUserVariableBool(id,xDirtyBit,i,false);");
code("aiPlanSetUserVariableInt(id,xNextBlock,i,i-1);");
code("}");
code("aiPlanAddUserVariableString(id,xVarNames,\"VarNames\",1);");
code("aiPlanSetUserVariableString(id,xVarNames,0,\"none\");");
code("return(id);");
code("}");
code("int xInitAddVar(int id = 0, string name = \"\", int type = 0) {");
code("int count = aiPlanGetNumberUserVariableValues(id,xDirtyBit);");
code("int index = aiPlanGetNumberUserVariableValues(id,xMetadata);");
code("aiPlanSetNumberUserVariableValues(id,xMetadata,index + 1,false);");
code("aiPlanSetUserVariableInt(id,xMetadata,index,type);");
code("index = aiPlanGetNumberUserVariableValues(id,xVarNames);");
code("aiPlanSetNumberUserVariableValues(id,xVarNames,index+1,false);");
code("aiPlanSetUserVariableString(id,xVarNames,index,name);");
code("index = xVarNames + index;");
code("switch(type)");
code("{");
code("case mInt:");
code("{");
code("aiPlanAddUserVariableInt(id,index,name,count);");
code("}");
code("case mFloat:");
code("{");
code("aiPlanAddUserVariableFloat(id,index,name,count);");
code("}");
code("case mString:");
code("{");
code("aiPlanAddUserVariableString(id,index,name,count);");
code("}");
code("case mVector:");
code("{");
code("aiPlanAddUserVariableVector(id,index,name,count);");
code("}");
code("case mBool:");
code("{");
code("aiPlanAddUserVariableBool(id,index,name,count);");
code("}");
code("}");
code("return(index);");
code("}");
code("int xInitAddInt(int id = 0, string name = \"\", int defVal = 0) {");
code("int index = xInitAddVar(id,name,mInt);");
code("aiPlanSetUserVariableInt(id, index, 0, defVal);");
code("return(index);");
code("}");
code("int xInitAddFloat(int id = 0, string name = \"\", float defVal = 0) {");
code("int index = xInitAddVar(id, name, mFloat);");
code("aiPlanSetUserVariableFloat(id, index, 0, defVal);");
code("return(index);");
code("}");
code("int xInitAddString(int id = 0, string name = \"\", string defVal = \"\") {");
code("int index = xInitAddVar(id, name, mString);");
code("aiPlanSetUserVariableString(id, index, 0, defVal);");
code("return(index);");
code("}");
code("int xInitAddVector(int id = 0, string name = \"\", vector defVal = vector(0,0,0)) {");
code("int index = xInitAddVar(id, name, mVector);");
code("aiPlanSetUserVariableVector(id, index, 0, defVal);");
code("return(index);");
code("}");
code("int xInitAddBool(int id = 0, string name = \"\", bool defVal = false) {");
code("int index = xInitAddVar(id,name,mBool);");
code("aiPlanSetUserVariableBool(id, index, 0, defVal);");
code("return(index);");
code("}");
code("void xResetValues(int id = 0, int index = -1, int stopAt = -1) {");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("if (stopAt == -1) {");
code("stopAt = aiPlanGetNumberUserVariableValues(id, xVarNames);");
code("} else {");
code("stopAt = stopAt - mVariableTypes;");
code("}");
code("for(i = 1; < stopAt) {");
code("switch(aiPlanGetUserVariableInt(id,xMetadata,mVariableTypes + i))");
code("{");
code("case mInt:");
code("{");
code("aiPlanSetUserVariableInt(id,xVarNames + i,index,aiPlanGetUserVariableInt(id,xVarNames + i,0));");
code("}");
code("case mFloat:");
code("{");
code("aiPlanSetUserVariableFloat(id,xVarNames + i,index,aiPlanGetUserVariableFloat(id,xVarNames + i,0));");
code("}");
code("case mString:");
code("{");
code("aiPlanSetUserVariableString(id,xVarNames + i,index,aiPlanGetUserVariableString(id,xVarNames + i,0));");
code("}");
code("case mVector:");
code("{");
code("aiPlanSetUserVariableVector(id,xVarNames + i,index,aiPlanGetUserVariableVector(id,xVarNames + i,0));");
code("}");
code("case mBool:");
code("{");
code("aiPlanSetUserVariableBool(id,xVarNames + i,index,aiPlanGetUserVariableBool(id,xVarNames + i,0));");
code("}");
code("}");
code("}");
code("}");
code("bool xSetPointer(int id = 0, int index = 0) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableBool(id,xDirtyBit,index)) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,index);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("int xAddDatabaseBlock(int id = 0, bool setPointer = false) {");
code("int next = aiPlanGetUserVariableInt(id,xMetadata,mNextFree);");
code("if (next == 0) {");
code("next = aiPlanGetNumberUserVariableValues(id,xDirtyBit);");
code("for(i=aiPlanGetNumberUserVariableValues(id,xVarNames) - 1; > 0) {");
code("aiPlanSetNumberUserVariableValues(id,i + xVarNames,next+1,false);");
code("}");
code("for(i=xPrevBlock; > xMetadata) {");
code("aiPlanSetNumberUserVariableValues(id,i,next+1,false);");
code("}");
code("} else {");
code("aiPlanSetUserVariableInt(id,xMetadata,mNextFree,aiPlanGetUserVariableInt(id,xNextBlock,next));");
code("}");
code("aiPlanSetUserVariableBool(id,xDirtyBit,next,true);");
code("if (aiPlanGetUserVariableInt(id,xMetadata,mCount) == 0) {");
code("aiPlanSetUserVariableInt(id,xNextBlock,next,next);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,next,next);");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,next);");
code("} else {");
code("int before = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("int after = aiPlanGetUserVariableInt(id,xNextBlock,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,next,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,next,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,next);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,next);");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mNewestBlock,next);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount, 1 + aiPlanGetUserVariableInt(id,xMetadata,mCount));");
code("xResetValues(id,next);");
code("if (setPointer) {");
code("xSetPointer(id, next);");
code("}");
code("return(next);");
code("}");
code("bool xFreeDatabaseBlock(int id = 0, int index = -1) {");
code("bool success = false;");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("if (aiPlanGetUserVariableBool(id,xDirtyBit,index)) {");
code("int after = aiPlanGetUserVariableInt(id,xNextBlock,index);");
code("int before = aiPlanGetUserVariableInt(id,xPrevBlock,index);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,index,aiPlanGetUserVariableInt(id,xMetadata,mNextFree));");
code("aiPlanSetUserVariableInt(id,xMetadata,mNextFree,index);");
code("aiPlanSetUserVariableBool(id,xDirtyBit,index,false);");
code("if (index == aiPlanGetUserVariableInt(id,xMetadata,mPointer)) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,aiPlanGetUserVariableInt(id,xPrevBlock,index));");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount, aiPlanGetUserVariableInt(id,xMetadata,mCount) - 1);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("bool xDetachDatabaseBlock(int id = 0, int index = -1) {");
code("bool success = false;");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("if (aiPlanGetUserVariableBool(id,xDirtyBit,index)) {");
code("int after = aiPlanGetUserVariableInt(id,xNextBlock,index);");
code("int before = aiPlanGetUserVariableInt(id,xPrevBlock,index);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,before);");
code("aiPlanSetUserVariableBool(id,xDirtyBit,index,false);");
code("if (index == aiPlanGetUserVariableInt(id,xMetadata,mPointer)) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,before);");
code("}");
code("if (aiPlanGetUserVariableInt(id,xMetadata,mCacheCount) == 0) {");
code("aiPlanSetUserVariableInt(id,xNextBlock,index,index);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,index,index);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheHead,index);");
code("} else {");
code("before = aiPlanGetUserVariableInt(id,xMetadata,mCacheHead);");
code("after = aiPlanGetUserVariableInt(id,xNextBlock,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,index,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,index,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,index);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,index);");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount, aiPlanGetUserVariableInt(id,xMetadata,mCount) - 1);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheCount, aiPlanGetUserVariableInt(id,xMetadata,mCacheCount) + 1);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("bool xRestoreDatabaseBlock(int id = 0, int index = -1) {");
code("bool success = false;");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mCacheHead);");
code("}");
code("if (aiPlanGetUserVariableBool(id,xDirtyBit,index) == false) {");
code("int after = aiPlanGetUserVariableInt(id,xNextBlock,index);");
code("int before = aiPlanGetUserVariableInt(id,xPrevBlock,index);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,before);");
code("aiPlanSetUserVariableBool(id,xDirtyBit,index,true);");
code("if (index == aiPlanGetUserVariableInt(id,xMetadata,mCacheHead)) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheHead,aiPlanGetUserVariableInt(id,xPrevBlock,index));");
code("}");
code("if (aiPlanGetUserVariableInt(id,xMetadata,mCount) == 0) {");
code("aiPlanSetUserVariableInt(id,xNextBlock,index,index);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,index,index);");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,index);");
code("} else {");
code("before = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("after = aiPlanGetUserVariableInt(id,xNextBlock,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,index,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,index,before);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,index);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,index);");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount, aiPlanGetUserVariableInt(id,xMetadata,mCount) + 1);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheCount, aiPlanGetUserVariableInt(id,xMetadata,mCacheCount) - 1);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("bool xRestoreCache(int id = 0) {");
code("bool success = false;");
code("if (aiPlanGetUserVariableInt(id,xMetadata,mCacheCount) > 0) {");
code("int pointer = aiPlanGetUserVariableInt(id,xMetadata,mCacheHead);");
code("for(i=aiPlanGetUserVariableInt(id,xMetadata,mCacheCount); >0) {");
code("aiPlanSetUserVariableBool(id,xDirtyBit,pointer,true);");
code("pointer = aiPlanGetUserVariableInt(id,xNextBlock,pointer);");
code("}");
code("if (aiPlanGetUserVariableInt(id,xMetadata,mCount) == 0) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,aiPlanGetUserVariableInt(id,xMetadata,mCacheHead));");
code("} else {");
code("int before = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("int after = aiPlanGetUserVariableInt(id,xNextBlock,before);");
code("int index = aiPlanGetUserVariableInt(id,xMetadata,mCacheHead);");
code("int next = aiPlanGetUserVariableInt(id,xPrevBlock,index);");
code("aiPlanSetUserVariableInt(id,xNextBlock,next,after);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,after,next);");
code("aiPlanSetUserVariableInt(id,xNextBlock,before,index);");
code("aiPlanSetUserVariableInt(id,xPrevBlock,index,before);");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount,");
code("aiPlanGetUserVariableInt(id,xMetadata,mCount) + aiPlanGetUserVariableInt(id,xMetadata,mCacheCount));");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheHead,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheCount,0);");
code("success = true;");
code("}");
code("return(success);");
code("}");
code("int xGetNewestPointer(int id = 0) {");
code("return(aiPlanGetUserVariableInt(id,xMetadata,mNewestBlock));");
code("}");
code("int xDatabaseNext(int id = 0, bool reverse = false) {");
code("int pointer = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("if (reverse) {");
code("pointer = aiPlanGetUserVariableInt(id,xPrevBlock,pointer);");
code("} else {");
code("pointer = aiPlanGetUserVariableInt(id,xNextBlock,pointer);");
code("}");
code("if (aiPlanGetUserVariableBool(id,xDirtyBit,pointer) && (aiPlanGetUserVariableInt(id,xMetadata,mCount) > 0)) {");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,pointer);");
code("} else {");
code("pointer = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("debugLog(\"xDatabaseNext: \" + aiPlanGetName(id) + \" pointer is incorrect!\");");
code("debugLog(\"xNextBlock: \" + aiPlanGetUserVariableInt(id,xNextBlock,pointer));");
code("debugLog(\"Me: \" + pointer);");
code("debugLog(\"xPrevblock: \" + aiPlanGetUserVariableInt(id,xPrevBlock,pointer));");
code("}");
code("return(pointer);");
code("}");
code("void xClearDatabase(int id = 0) {");
code("int next = aiPlanGetUserVariableInt(id,xMetadata,mNextFree);");
code("int pointer = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("aiPlanSetUserVariableInt(id,xMetadata,mNextFree,aiPlanGetUserVariableInt(id,xNextBlock,pointer));");
code("aiPlanSetUserVariableInt(id,xNextBlock,pointer,next);");
code("for(i=0; < aiPlanGetNumberUserVariableValues(id,xDirtyBit)) {");
code("aiPlanSetUserVariableBool(id,xDirtyBit,i,false);");
code("}");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,0);");
code("}");
code("void xResetDatabase(int id = 0) {");
code("int size = aiPlanGetNumberUserVariableValues(id,xDirtyBit);");
code("aiPlanSetUserVariableInt(id,xMetadata,mPointer,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCount,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheHead,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mCacheCount,0);");
code("aiPlanSetUserVariableInt(id,xMetadata,mNextFree,size - 1);");
code("aiPlanSetUserVariableInt(id,xNextBlock,0,0);");
code("for(i=1; < size) {");
code("aiPlanSetUserVariableBool(id,xDirtyBit,i,false);");
code("aiPlanSetUserVariableInt(id,xNextBlock,i,i-1);");
code("}");
code("}");
code("int xGetInt(int id = 0, int data = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mInt) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetInt: \" + aiPlanGetName(id) + \" variable \" + name + \" is not an int! Type: \" + type);");
code("return(-1);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanGetUserVariableInt(id,data,index));");
code("}");
code("bool xSetInt(int id = 0, int data = 0, int val = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mInt) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xSetInt: \" + aiPlanGetName(id) + \" variable \" + name + \" is not an int! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("bool success = aiPlanSetUserVariableInt(id,data,index,val);");
code("if (success == false) {");
code("string err = \": Could not assign value: \" + val;");
code("debugLog(\"xSetInt: \" + aiPlanGetName(id) + aiPlanGetUserVariableString(id,xVarNames,data - xVarNames) + err);");
code("}");
code("return(success);");
code("}");
code("float xGetFloat(int id = 0, int data = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mFloat) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetFloat: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a float! Type: \" + type);");
code("return(-1.0);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanGetUserVariableFloat(id,data,index));");
code("}");
code("bool xSetFloat(int id = 0, int data = 0, float val = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mFloat) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xSetFloat: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a float! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("bool success = aiPlanSetUserVariableFloat(id,data,index,val);");
code("if (success == false) {");
code("string err = \": Could not assign value: \" + val;");
code("debugLog(\"xSetFloat: \" + aiPlanGetName(id) + aiPlanGetUserVariableString(id,xVarNames,data - xVarNames) + err);");
code("}");
code("return(success);");
code("}");
code("string xGetString(int id = 0, int data = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mString) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetString: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a string! Type: \" + type);");
code("return(\"\");");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanGetUserVariableString(id,data,index));");
code("}");
code("bool xSetString(int id = 0, int data = 0, string val = \"\", int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mString) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xSetString: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a string! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanSetUserVariableString(id,data,index,val));");
code("}");
code("vector xGetVector(int id = 0, int data = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mVector) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetVector: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a vector! Type: \" + type);");
code("return(vector(0,0,0));");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanGetUserVariableVector(id,data,index));");
code("}");
code("bool xSetVector(int id = 0, int data = 0, vector val = vector(0,0,0), int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mVector) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xSetVector: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a vector! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanSetUserVariableVector(id,data,index,val));");
code("}");
code("bool xGetBool(int id = 0, int data = 0, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mBool) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetBool: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a bool! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanGetUserVariableBool(id,data,index));");
code("}");
code("bool xSetBool(int id = 0, int data = 0, bool val = false, int index = -1) {");
code("if (aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes) != mBool) {");
code("string type = datatypeName(aiPlanGetUserVariableInt(id,xMetadata,data - xVarNames + mVariableTypes));");
code("string name = aiPlanGetUserVariableString(id,xVarNames,data - xVarNames);");
code("debugLog(\"xGetBool: \" + aiPlanGetName(id) + \" variable \" + name + \" is not a bool! Type: \" + type);");
code("return(false);");
code("}");
code("if (index == -1) {");
code("index = aiPlanGetUserVariableInt(id,xMetadata,mPointer);");
code("}");
code("return(aiPlanSetUserVariableBool(id,data,index,val));");
code("}");
code("int xGetDatabaseCount(int id = 0) {");
code("return(aiPlanGetUserVariableInt(id,xMetadata,mCount));");
code("}");
code("int xGetPointer(int id = 0) {");
code("return(aiPlanGetUserVariableInt(id,xMetadata,mPointer));");
code("}");
code("void xPrintAll(int id = 0, int index = 0) {");
code("trChatSend(0, \"<u>\" + aiPlanGetName(id) + \"</u>\");");
code("trChatSend(0, \"size: \" + xGetDatabaseCount(id));");
code("trChatSend(0, \"pointer: \" + index);");
code("for(i=1; < aiPlanGetNumberUserVariableValues(id,xVarNames)) {");
code("string name = aiPlanGetUserVariableString(id,xVarNames,i);");
code("int type = aiPlanGetUserVariableInt(id,xMetadata,mVariableTypes + i);");
code("switch(type)");
code("{");
code("case mInt:");
code("{");
code("trChatSend(0, name + \": \" + aiPlanGetUserVariableInt(id,xVarNames + i,index));");
code("}");
code("case mFloat:");
code("{");
code("trChatSend(0, name + \": \" + aiPlanGetUserVariableFloat(id,xVarNames + i,index));");
code("}");
code("case mString:");
code("{");
code("trChatSend(0, name + \": \" + aiPlanGetUserVariableString(id,xVarNames + i,index));");
code("}");
code("case mVector:");
code("{");
code("trChatSend(0, name + \": \" + aiPlanGetUserVariableVector(id,xVarNames + i,index));");
code("}");
code("case mBool:");
code("{");
code("if (aiPlanGetUserVariableBool(id,xVarNames + i,index)) {");
code("trChatSend(0, name + \": true\");");
code("} else {");
code("trChatSend(0, name + \": false\");");
code("}");
code("}");
code("}");
code("}");
code("}");
code("void xUnitSelect(int id = 0, int varn = 0, bool reverse = true) {");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+xGetInt(id,varn), reverse);");
code("}");
code("void xUnitSelectByID(int db = 0, int varn = 0) {");
code("trUnitSelectClear();");
code("trUnitSelectByID(xGetInt(db,varn));");
code("}");
code("rule mInitializeMemory");
code("active");
code("highFrequency");
code("{");
code("xsDisableSelf();");
code("aiSet(\"NoAI\", 0);");
code("MALLOC = aiPlanCreate(\"memory\",8);");
code("ARRAYS = aiPlanCreate(\"arrays\",8);");
code("for(i=0; < 5) {");
code("aiPlanAddUserVariableBool(MALLOC,i * 3 + xDirtyBit - 1,\"DirtyBit\"+i,1);");
code("aiPlanAddUserVariableInt(MALLOC,i * 3 + xNextBlock - 1,\"NextBlock\"+i,1);");
code("aiPlanSetUserVariableBool(MALLOC,i * 3 + xDirtyBit - 1, NEXTFREE, true);");
code("aiPlanSetUserVariableInt(MALLOC,i * 3 + xNextBlock - 1, NEXTFREE, 0);");
code("}");
code("aiPlanAddUserVariableInt(MALLOC,mInt * 3 + xData - 1, \"intData\",1);");
code("aiPlanAddUserVariableFloat(MALLOC,mFloat * 3 + xData - 1, \"floatData\",1);");
code("aiPlanAddUserVariableString(MALLOC,mString * 3 + xData - 1, \"stringData\",1);");
code("aiPlanAddUserVariableVector(MALLOC,mVector * 3 + xData - 1, \"vectorData\",1);");
code("aiPlanAddUserVariableBool(MALLOC,mBool * 3 + xData - 1, \"boolData\",1);");
code("aiPlanAddUserVariableString(MALLOC,15,\"datatypes\",5);");
code("aiPlanSetUserVariableString(MALLOC,15,mInt,\"Integer\");");
code("aiPlanSetUserVariableString(MALLOC,15,mFloat,\"Float\");");
code("aiPlanSetUserVariableString(MALLOC,15,mString,\"String\");");
code("aiPlanSetUserVariableString(MALLOC,15,mVector,\"Vector\");");
code("aiPlanSetUserVariableString(MALLOC,15,mBool,\"Bool\");");
code("}");
code("void trVectorQuestVarSet(string name = \"\", vector QVv = vector(-1,-1,-1)) {");
code("if (name == \"\") return;");
code("if (trQuestVarGet(\"vector\"+name) == 0) {");
code("trQuestVarSet(\"vector\"+name, zNewVector(QVv));");
code("} else {");
code("zSetVector(1*trQuestVarGet(\"vector\"+name),QVv);");
code("}");
code("}");
code("vector trVectorQuestVarGet(string name = \"\") {");
code("return(zGetVector(1*trQuestVarGet(\"vector\"+name)));");
code("}");
code("float trVectorQuestVarGetX(string name = \"\") {");
code("return(xsVectorGetX(trVectorQuestVarGet(name)));");
code("}");
code("float trVectorQuestVarGetY(string name = \"\") {");
code("return(xsVectorGetY(trVectorQuestVarGet(name)));");
code("}");
code("float trVectorQuestVarGetZ(string name = \"\") {");
code("return(xsVectorGetZ(trVectorQuestVarGet(name)));");
code("}");
code("void trVectorQuestVarEcho(string name = \"\") {");
code("if (name == \"\") return;");
code("trChatSend(0, \"\"+name+\": \"+trVectorQuestVarGet(name));");
code("}");
code("void trStringQuestVarSet(string name = \"\", string value = \"\") {");
code("if (trQuestVarGet(\"string\"+name) > 0) {");
code("zSetString(1*trQuestVarGet(\"string\"+name), value);");
code("} else {");
code("trQuestVarSet(\"string\"+name, zNewString(value));");
code("}");
code("}");
code("string trStringQuestVarGet(string name=\"\") {");
code("string val = zGetString(1*trQuestVarGet(\"string\"+name));");
code("return(val);");
code("}");
code("bool playerIsPlaying(int p = 0) {");
code("return(kbIsPlayerHuman(p) == true && kbIsPlayerResigned(p) == false && trPlayerDefeated(p) == false);");
code("}");
code("void trUnitTeleportToVector(string v = \"\") {");
code("vector pos = trVectorQuestVarGet(v);");
code("trUnitTeleport(xsVectorGetX(pos),xsVectorGetY(pos),xsVectorGetZ(pos));");
code("}");
code("void trUnitSelectByQV(string s = \"\", bool reverse = true) {");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"\"+s), reverse);");
code("}");
code("void trVectorSetUnitPos(string v = \"\", string db = \"\", bool reverse = true) {");
code("trVectorQuestVarSet(v, kbGetBlockPosition(\"\"+1*trQuestVarGet(db), reverse));");
code("}");
code("void trVectorSetUnitPosInt(string v = \"\", int val = 0, bool reverse = true) {");
code("trVectorQuestVarSet(v, kbGetBlockPosition(\"\"+val, reverse));");
code("}");
code("void trUnitMoveToVector(string v = \"\", bool attack = false) {");
code("trUnitMoveToPoint(trVectorQuestVarGetX(v),0,trVectorQuestVarGetZ(v),-1,attack);");
code("}");
code("void trVectorScale(string db = \"\", float s = 1.0) {");
code("trVectorQuestVarSet(db, trVectorQuestVarGet(db) * s);");
code("}");
code("vector vectorSnapToGrid(vector v = vector(0,0,0)) {");
code("int x = xsVectorGetX(v) / 2;");
code("int z = xsVectorGetZ(v) / 2;");
code("return(xsVectorSet(x * 2 + 1,xsVectorGetY(v),z * 2 + 1));");
code("}");
code("void trVectorSnapToGrid(string qv = \"\") {");
code("trVectorQuestVarSet(qv, vectorSnapToGrid(trVectorQuestVarGet(qv)));");
code("}");
code("int iModulo(int mod = 10, int val = 0) {");
code("return(val - val / mod * mod);");
code("}");
code("float fModulo(float mod = 0, float val = 0) {");
code("int c = 0;");
code("if (val > 0) {");
code("c = val / mod;");
code("} else {");
code("c = val / mod - 1;");
code("}");
code("return(0.0 + val - mod * c);");
code("}");
code("bool getBit(int bit = 0, int val = 0) {");
code("val = val / xsPow(2, bit);");
code("return((iModulo(2, val) == 1));");
code("}");
code("void zUnitHeading(float a = 0) {");
code("trSetUnitOrientation(xsVectorSet(xsSin(a),0,xsCos(a)), xsVectorSet(0,1,0), true);");
code("}");
code("void zInitProtoUnitStat(string r = \"\", int p = 0, int f = 0, float v = 0.0) {");
code("trQuestVarSet(\"p\"+p+\"pf\"+kbGetProtoUnitID(r)+\"f\"+f, v);");
code("}");
code("void zSetProtoUnitStat(string r = \"\", int p = 0, int f = 0, float v = 0.0) {");
code("for(zsps=0; >1){}");
code("zsps = kbGetProtoUnitID(r);");
code("trModifyProtounit(r, p, f, 0.0 + v - trQuestVarGet(\"p\"+p+\"pf\"+zsps+\"f\"+f));");
code("trQuestVarSet(\"p\"+p+\"pf\"+zsps+\"f\"+f, 0.0 + v);");
code("}");
code("vector vectorToGrid(vector v = vector(0,0,0)) {");
code("return(xsVectorSet(0 + xsVectorGetX(v) / 2,xsVectorGetY(v),0 + xsVectorGetZ(v) / 2));");
code("}");
code("void trVectorToGrid(string from = \"\", string to = \"\"){");
code("trVectorQuestVarSet(to, vectorToGrid(trVectorQuestVarGet(from)));");
code("}");
code("vector gridToVector(vector g = vector(0,0,0)) {");
code("return(xsVectorSet(xsVectorGetX(g) * 2 + 1,xsVectorGetY(g),xsVectorGetZ(g) * 2 + 1));");
code("}");
code("void trGridToVector(string from = \"\", string to = \"\") {");
code("trVectorQuestVarSet(to, gridToVector(trVectorQuestVarGet(from)));");
code("}");
code("void trSquareVar(string qv = \"\") {");
code("trQuestVarSet(qv, xsPow(trQuestVarGet(qv), 2));");
code("}");
code("float distanceBetweenVectors(vector start = vector(0,0,0), vector end = vector(0,0,0), bool squared = true) {");
code("float xDiff = xsVectorGetX(end) - xsVectorGetX(start);");
code("float zDiff = xsVectorGetZ(end) - xsVectorGetZ(start);");
code("float dist = xDiff * xDiff + zDiff * zDiff;");
code("if (squared == false) {");
code("dist = xsSqrt(dist);");
code("}");
code("return(dist);");
code("}");
code("float trDistanceBetweenVectorsSquared(string start = \"\", string end = \"\") {");
code("return(distanceBetweenVectors(trVectorQuestVarGet(start),trVectorQuestVarGet(end)));");
code("}");
code("bool vectorInRectangle(vector pos = vector(0,0,0), vector bot = vector(0,0,0), vector top = vector(0,0,0)) {");
code("if (xsVectorGetX(pos) < xsVectorGetX(bot)) {");
code("return(false);");
code("}");
code("if (xsVectorGetX(pos) > xsVectorGetX(top)) {");
code("return(false);");
code("}");
code("if (xsVectorGetZ(pos) < xsVectorGetZ(bot)) {");
code("return(false);");
code("}");
code("if (xsVectorGetZ(pos) > xsVectorGetZ(top)) {");
code("return(false);");
code("}");
code("return(true);");
code("}");
code("bool trVectorInRectangle(string pos = \"\", string bot = \"\", string top = \"\") {");
code("vector tempPos = zGetVector(1*trQuestVarGet(pos));");
code("vector tempBot = zGetVector(1*trQuestVarGet(bot));");
code("vector tempTop = zGetVector(1*trQuestVarGet(top));");
code("return(vectorInRectangle(tempPos,tempBot,tempTop));");
code("}");
code("vector rotationMatrix(vector v = vector(0,0,0), float cosT = 0, float sinT = 0) {");
code("float x = xsVectorGetX(v);");
code("float z = xsVectorGetZ(v);");
code("vector ret = xsVectorSet(x * cosT - z * sinT, 0, x * sinT + z * cosT);");
code("return(ret);");
code("}");
code("float trDistanceBetweenVectors(string start = \"\", string end = \"\") {");
code("return(distanceBetweenVectors(trVectorQuestVarGet(start),trVectorQuestVarGet(end),false));");
code("}");
code("float distanceBetweenVectors3d(vector start = vector(0,0,0), vector end = vector(0,0,0), bool squared = true) {");
code("float xdiff = xsVectorGetX(start) - xsVectorGetX(end);");
code("float ydiff = xsVectorGetY(start) - xsVectorGetY(end);");
code("float zdiff = xsVectorGetZ(start) - xsVectorGetZ(end);");
code("float dist = xdiff * xdiff + ydiff * ydiff + zdiff * zdiff;");
code("if (squared == false) {");
code("dist = xsSqrt(dist);");
code("}");
code("return(dist);");
code("}");
code("float trDistanceBetweenVectors3d(string start = \"\", string end = \"\") {");
code("return(distanceBetweenVectors3d(trVectorQuestVarGet(start),trVectorQuestVarGet(end),false));");
code("}");
code("float unitDistanceToVector(int name = 0, vector v = vector(0,0,0), bool squared = true) {");
code("vector temp = kbGetBlockPosition(\"\"+name,true);");
code("return(distanceBetweenVectors(temp,v,squared));");
code("}");
code("float trDistanceToVectorSquared(string qv = \"\", string v = \"\") {");
code("return(unitDistanceToVector(1*trQuestVarGet(qv),trVectorQuestVarGet(v)));");
code("}");
code("float trDistanceToVector(string qv = \"\", string v = \"\") {");
code("return(unitDistanceToVector(1*trQuestVarGet(qv),trVectorQuestVarGet(v),false));");
code("}");
code("vector vectorSetFromAngle(float angle = 0) {");
code("return(xsVectorSet(xsSin(angle), 0, xsCos(angle)));");
code("}");
code("void trVectorSetFromAngle(string qv = \"\", float angle = 0) {");
code("trVectorQuestVarSet(qv,xsVectorSet(xsSin(angle), 0, xsCos(angle)));");
code("}");
code("float angleBetweenVectors(vector from = vector(0,0,0), vector to = vector(0,0,0)) {");
code("float a = xsVectorGetX(to) - xsVectorGetX(from);");
code("a = a / (xsVectorGetZ(to) - xsVectorGetZ(from));");
code("a = xsAtan(a);");
code("if (xsVectorGetZ(from) > xsVectorGetZ(to)) {");
code("if (xsVectorGetX(from) > xsVectorGetX(to)) {");
code("a = a - PI;");
code("} else {");
code("a = a + PI;");
code("}");
code("}");
code("return(a);");
code("}");
code("float trAngleBetweenVectors(string from = \"\", string to = \"\") {");
code("return(angleBetweenVectors(trVectorQuestVarGet(from),trVectorQuestVarGet(to)));");
code("}");
code("float angleOfVector(vector dir = vector(0,0,0)) {");
code("float a = xsVectorGetX(dir) / xsVectorGetZ(dir);");
code("a = xsAtan(a);");
code("if (0.0 > xsVectorGetZ(dir)) {");
code("if (0.0 > xsVectorGetX(dir)) {");
code("a = a - PI;");
code("} else {");
code("a = a + PI;");
code("}");
code("}");
code("return(a);");
code("}");
code("float trAngleOfVector(string v = \"\") {");
code("return(angleOfVector(trVectorQuestVarGet(v)));");
code("}");
code("vector getUnitVector(vector start = vector(0,0,0), vector end = vector(0,0,0), float mod = 1.0) {");
code("float xdiff = xsVectorGetX(end) - xsVectorGetX(start);");
code("float zdiff = xsVectorGetZ(end) - xsVectorGetZ(start);");
code("float dist = xsSqrt(xdiff * xdiff + zdiff * zdiff);");
code("vector ret = vector(1,0,0);");
code("if (dist > 0) {");
code("ret = xsVectorSet(xdiff / dist * mod, 0, zdiff / dist * mod);");
code("}");
code("return(ret);");
code("}");
code("vector trGetUnitVector(string start = \"\", string end = \"\", float mod = 1.0) {");
code("return(getUnitVector(trVectorQuestVarGet(start),trVectorQuestVarGet(end),mod));");
code("}");
code("vector getUnitVector3d(vector start = vector(0,0,0), vector end = vector(0,0,0), float mod = 1.0) {");
code("float xdiff = xsVectorGetX(end) - xsVectorGetX(start);");
code("float ydiff = xsVectorGetY(end) - xsVectorGetY(start);");
code("float zdiff = xsVectorGetZ(end) - xsVectorGetZ(start);");
code("float dist = xsSqrt(xdiff * xdiff + ydiff * ydiff + zdiff * zdiff);");
code("vector ret = vector(0,1,0);");
code("if (dist > 0) {");
code("ret = xsVectorSet(xdiff / dist * mod, ydiff / dist * mod, zdiff / dist * mod);");
code("}");
code("return(ret);");
code("}");
code("vector trGetUnitVector3d(string start = \"\", string end = \"\", float mod = 1.0) {");
code("return(getUnitVector3d(trVectorQuestVarGet(start),trVectorQuestVarGet(end),mod));");
code("}");
code("vector crossProduct(vector a = vector(0,0,0), vector b = vector(0,0,0)) {");
code("float x = xsVectorGetY(a) * xsVectorGetZ(b) - xsVectorGetZ(a) * xsVectorGetY(b);");
code("float y = xsVectorGetZ(a) * xsVectorGetX(b) - xsVectorGetX(a) * xsVectorGetZ(b);");
code("float z = xsVectorGetX(a) * xsVectorGetY(b) - xsVectorGetY(a) * xsVectorGetX(b);");
code("vector ret = xsVectorSet(x, y, z);");
code("return(ret);");
code("}");
code("float dotProduct(vector a = vector(0,0,0), vector b = vector(0,0,0)) {");
code("return(xsVectorGetX(a) * xsVectorGetX(b) + xsVectorGetZ(a) * xsVectorGetZ(b));");
code("}");
code("bool terrainIsType(vector v = vector(0,0,0), int type = 0, int subtype = 0) {");
code("bool isType = trGetTerrainType(xsVectorGetX(v),xsVectorGetZ(v)) == type;");
code("isType = trGetTerrainSubType(xsVectorGetX(v),xsVectorGetZ(v)) == subtype;");
code("return(isType);");
code("}");
code("bool trTerrainIsType(string qv = \"\", int type = 0, int subtype = 0) {");
code("return(terrainIsType(trVectorQuestVarGet(qv),type,subtype));");
code("}");
code("void modularCounterInit(string name = \"\", int size = 0) {");
code("trQuestVarSet(\"counter\" + name + \"size\", size);");
code("trQuestVarSet(\"counter\" + name + \"pointer\", 1);");
code("trQuestVarSet(name, 1);");
code("}");
code("int modularCounterNext(string name = \"\") {");
code("trQuestVarSet(\"counter\" + name + \"pointer\", 1 + trQuestVarGet(\"counter\" + name + \"pointer\"));");
code("if (trQuestVarGet(\"counter\" + name + \"pointer\") > trQuestVarGet(\"counter\" + name + \"size\")) {");
code("trQuestVarSet(\"counter\" + name + \"pointer\", 1);");
code("}");
code("trQuestVarSet(name, trQuestVarGet(\"counter\"+name+\"pointer\"));");
code("return(0 + trQuestVarGet(\"counter\" + name + \"pointer\"));");
code("}");
code("int peekModularCounterNext(string name = \"\") {");
code("trQuestVarSet(\"counter\" + name + \"fake\", 1 + trQuestVarGet(\"counter\" + name + \"pointer\"));");
code("if (trQuestVarGet(\"counter\" + name + \"fake\") >= trQuestVarGet(\"counter\" + name + \"size\")) {");
code("trQuestVarSet(\"counter\" + name + \"fake\", 1);");
code("}");
code("return(0 + trQuestVarGet(\"counter\" + name + \"fake\"));");
code("}");
code("bool yDatabaseCreateIfNull(string dbname = \"\", int count = 0) {");
code("bool created = false;");
code("if (trQuestVarGet(\"database\"+dbname) == 0) {");
code("if (count < 0) {");
code("count = 0;");
code("}");
code("trQuestVarSet(\"database\"+dbname, xInitDatabase(dbname, count));");
code("created = true;");
code("}");
code("return(created);");
code("}");
code("bool yVariableExists(string dbname = \"\", string varname = \"\") {");
code("int db = trQuestVarGet(\"database\"+dbname);");
code("int var = trQuestVarGet(\"database\"+dbname+varname);");
code("return(db * var > 0);");
code("}");
code("float yGetVarAtIndex(string db = \"\", string var = \"\", int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("return(xGetFloat(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),index));");
code("} else {");
code("return(0);");
code("}");
code("}");
code("float yGetVar(string db = \"\", string var = \"\") {");
code("return(yGetVarAtIndex(db, var, -1));");
code("}");
code("string yGetStringAtIndex(string db = \"\", string var = \"\", int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("return(xGetString(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),index));");
code("} else {");
code("return(\"\");");
code("}");
code("}");
code("string yGetString(string db = \"\", string var = \"\") {");
code("return(yGetStringAtIndex(db, var, -1));");
code("}");
code("vector yGetVectorAtIndex(string db = \"\", string var = \"\", int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("return(xGetVector(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),index));");
code("} else {");
code("return(vector(0,0,0));");
code("}");
code("}");
code("vector yGetVector(string db = \"\", string var = \"\") {");
code("return(yGetVectorAtIndex(db, var, -1));");
code("}");
code("void ySetVarAtIndex(string db = \"\", string var = \"\", float val = 0, int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("xSetFloat(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("} else {");
code("yDatabaseCreateIfNull(db, index);");
code("trQuestVarSet(\"database\"+db+var, xInitAddFloat(1*trQuestVarGet(\"database\"+db),var));");
code("xSetFloat(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("}");
code("}");
code("void ySetVar(string db = \"\", string var = \"\", float val = 0) {");
code("ySetVarAtIndex(db, var, val, -1);");
code("}");
code("void ySetStringAtIndex(string db = \"\", string var = \"\", string val = \"\", int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("xSetString(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("} else {");
code("yDatabaseCreateIfNull(db, index);");
code("trQuestVarSet(\"database\"+db+var, xInitAddFloat(1*trQuestVarGet(\"database\"+db),var));");
code("xSetString(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("}");
code("}");
code("void ySetString(string db = \"\", string var = \"\", string val = \"\") {");
code("ySetStringAtIndex(db, var, val, -1);");
code("}");
code("void ySetVectorAtIndex(string db = \"\", string var = \"\", vector val = vector(0,0,0), int index = 0) {");
code("if (yVariableExists(db, var)) {");
code("xSetVector(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("} else {");
code("yDatabaseCreateIfNull(db, index);");
code("trQuestVarSet(\"database\"+db+var, xInitAddFloat(1*trQuestVarGet(\"database\"+db),var));");
code("xSetVector(1*trQuestVarGet(\"database\"+db),1*trQuestVarGet(\"database\"+db+var),val,index);");
code("}");
code("}");
code("void ySetVector(string db = \"\", string var = \"\", vector val = vector(0,0,0)) {");
code("ySetVectorAtIndex(db, var, val, -1);");
code("}");
code("int yDatabaseNext(string db = \"\", bool select = false, bool reverse = false) {");
code("xDatabaseNext(1*trQuestVarGet(\"database\"+db), reverse);");
code("int u = yGetVar(db, \"unitName\");");
code("trQuestVarSet(db, u);");
code("if (select) {");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+u, true);");
code("return(kbGetBlockID(\"\"+u, true));");
code("} else {");
code("return(u);");
code("}");
code("}");
code("void yRemoveFromDatabase(string db = \"\") {");
code("xFreeDatabaseBlock(1*trQuestVarGet(\"database\"+db));");
code("}");
code("int yGetNewestPointer(string db = \"\") {");
code("return(xGetNewestPointer(1*trQuestVarGet(\"database\"+db)));");
code("}");
code("void yAddUpdateVar(string db = \"\", string var = \"\", float val = 0) {");
code("ySetVarAtIndex(db, var, val, yGetNewestPointer(db));");
code("}");
code("void yAddUpdateString(string db = \"\", string var = \"\", string val = \"\") {");
code("ySetStringAtIndex(db, var, val, yGetNewestPointer(db));");
code("}");
code("void yAddUpdateVector(string db = \"\", string var = \"\", vector val = vector(0,0,0)) {");
code("ySetVectorAtIndex(db, var, val, yGetNewestPointer(db));");
code("}");
code("int yAddToDatabase(string db = \"\", string val = \"\") {");
code("yDatabaseCreateIfNull(db);");
code("int id = trQuestVarGet(\"database\"+db);");
code("int next = xAddDatabaseBlock(id);");
code("yAddUpdateVar(db, \"unitName\", trQuestVarGet(val));");
code("return(next);");
code("}");
code("int yGetPointer(string db = \"\") {");
code("return(xGetPointer(1*trQuestVarGet(\"database\"+db)));");
code("}");
code("bool ySetPointer(string db = \"\", int index = 0) {");
code("bool safe = xSetPointer(1*trQuestVarGet(\"database\"+db), index);");
code("if (safe) {");
code("trQuestVarSet(db, yGetVar(db, \"unitName\"));");
code("}");
code("return(safe);");
code("}");
code("int yGetDatabaseCount(string db = \"\") {");
code("return(xGetDatabaseCount(1*trQuestVarGet(\"database\"+db)));");
code("}");
code("int yGetUnitAtIndex(string db = \"\", int index = 0) {");
code("return(1*yGetVarAtIndex(db, \"unitName\", index));");
code("}");
code("void ySetUnitAtIndex(string db = \"\", int index = 0, int value = 0) {");
code("ySetVarAtIndex(db, \"unitName\", value, index);");
code("}");
code("void ySetUnit(string db = \"\", int value = 0) {");
code("ySetVar(db, \"unitName\", value);");
code("}");
code("void yClearDatabase(string db = \"\") {");
code("xClearDatabase(1*trQuestVarGet(\"database\"+db));");
code("}");
code("int yFindLatestReverse(string qv = \"\", string proto = \"\", int p = 0) {");
code("int id = kbGetProtoUnitID(proto);");
code("trUnitSelectClear();");
code("for(x=trGetNextUnitScenarioNameNumber(); >trQuestVarGet(qv)) {");
code("int i = kbGetBlockID(\"\"+x, true);");
code("if (kbGetUnitBaseTypeID(i) == id) {");
code("trUnitSelectClear();");
code("trUnitSelectByID(i);");
code("if (trUnitIsOwnedBy(p)) {");
code("trQuestVarSet(qv, x);");
code("return(i);");
code("}");
code("}");
code("}");
code("return(-1);");
code("}");
code("int yFindLatest(string qv = \"\", string proto = \"\", int p = 0) {");
code("int id = kbGetProtoUnitID(proto);");
code("trUnitSelectClear();");
code("int next = trGetNextUnitScenarioNameNumber() - 1;");
code("int current = trQuestVarGet(qv);");
code("while(next > current) {");
code("current = current + 1;");
code("int i = kbGetBlockID(\"\"+current, true);");
code("if (kbGetUnitBaseTypeID(i) == id) {");
code("trUnitSelectClear();");
code("trUnitSelectByID(i);");
code("if (trUnitIsOwnedBy(p)) {");
code("trQuestVarSet(qv, current);");
code("return(i);");
code("}");
code("}");
code("}");
code("return(-1);");
code("}");
}
void voids() {
code("int deployLocHeading(float posX = 0.0, float PosZ = 0.0, string unit = \"\", int p = 0, float heading = 0.0){");
code("int unitId = trGetNextUnitScenarioNameNumber();");
code("trArmyDispatch(\"\"+p+\",0\",unit,1,posX,0,PosZ,heading,true);");
code("if(unitId != trGetNextUnitScenarioNameNumber()){");
code("return (unitId);");
code("} else {");
code("return (-1);");
code("}");
code("}");
code("int deployLoc(float posX = 0.0, float PosZ = 0.0, string unit = \"\", int p = 0){");
code("int unitId = trGetNextUnitScenarioNameNumber();");
code("trArmyDispatch(\"\"+p+\",0\",unit,1,posX,0,PosZ,0,true);");
code("if(unitId != trGetNextUnitScenarioNameNumber()){");
code("return (unitId);");
code("} else {");
code("return (-1);");
code("}");
code("}");
code("void playSound(string soundName = \"\"){");
code("trSoundPlayPaused(\"\"+soundName+\"\", \"1\", -1, \"\", \"\");");
code("}");
code("int deployLocRandomHeading(float posX = 0.0, float PosZ = 0.0, string unit = \"\", int p = 0){");
code("int unitId = trGetNextUnitScenarioNameNumber();");
code("trQuestVarSetFromRand(\"heading\", 0, 359, true);");
code("trArmyDispatch(\"\"+p+\",0\",unit,1,posX,0,PosZ,1*trQuestVarGet(\"heading\"),true);");
code("if(unitId != trGetNextUnitScenarioNameNumber()){");
code("return (unitId);");
code("} else {");
code("return (-1);");
code("}");
code("}");
code("int getTerrainType(string name = \"\"){");
code("if(name == \"GrassA\")return (0);");
code("if(name == \"GrassB\")return (0);");
code("if(name == \"GrassDirt25\")return (0);");
code("if(name == \"GrassDirt50\")return (0);");
code("if(name == \"GrassDirt75\")return (0);");
code("if(name == \"CliffGreekB\")return (0);");
code("if(name == \"GreekRoad Burnt\")return (0);");
code("if(name == \"GreekRoad BurntB\")return (0);");
code("if(name == \"GaiaCreepA\")return (0);");
code("if(name == \"GaiaCreepASnow\")return (0);");
code("if(name == \"GaiaCreepASand\")return (0);");
code("if(name == \"GaiaCreepB\")return (0);");
code("if(name == \"GaiaCreepBorder\")return (0);");
code("if(name == \"GaiaCreepBorderSnow\")return (0);");
code("if(name == \"GaiaCreepBorderSand\")return (0);");
code("if(name == \"SavannahA\")return (0);");
code("if(name == \"SavannahB\")return (0);");
code("if(name == \"SavannahC\")return (0);");
code("if(name == \"SavannahD\")return (0);");
code("if(name == \"JungleA\")return (0);");
code("if(name == \"JungleB\")return (0);");
code("if(name == \"JungleDirt25\")return (0);");
code("if(name == \"JungleDirt50\")return (0);");
code("if(name == \"JungleDirt75\")return (0);");
code("if(name == \"CliffJungleB\")return (0);");
code("if(name == \"PlainA\")return (0);");
code("if(name == \"PlainB\")return (0);");
code("if(name == \"PlainDirt25\")return (0);");
code("if(name == \"PlainDirt50\")return (0);");
code("if(name == \"PlainDirt75\")return (0);");
code("if(name == \"CliffPlainB\")return (0);");
code("if(name == \"DirtA\")return (0);");
code("if(name == \"DirtB\")return (0);");
code("if(name == \"DirtC\")return (0);");
code("if(name == \"SandA\")return (0);");
code("if(name == \"SandB\")return (0);");
code("if(name == \"SandC\")return (0);");
code("if(name == \"SandD\")return (0);");
code("if(name == \"CliffEgyptianB\")return (0);");
code("if(name == \"SandDirt50\")return (0);");
code("if(name == \"SandDirt50b\")return (0);");
code("if(name == \"SnowA\")return (0);");
code("if(name == \"SnowB\")return (0);");
code("if(name == \"SnowGrass25\")return (0);");
code("if(name == \"SnowGrass50\")return (0);");
code("if(name == \"SnowGrass75\")return (0);");
code("if(name == \"SnowSand25\")return (0);");
code("if(name == \"SnowSand50\")return (0);");
code("if(name == \"SnowSand75\")return (0);");
code("if(name == \"CliffNorseB\")return (0);");
code("if(name == \"OlympusA\")return (0);");
code("if(name == \"OlympusB\")return (0);");
code("if(name == \"OlympusC\")return (0);");
code("if(name == \"OlympusTile\")return (0);");
code("if(name == \"TundraGrassA\")return (0);");
code("if(name == \"TundraGrassB\")return (0);");
code("if(name == \"TundraRockA\")return (0);");
code("if(name == \"TundraRockB\")return (0);");
code("if(name == \"MarshA\")return (0);");
code("if(name == \"MarshB\")return (0);");
code("if(name == \"MarshC\")return (0);");
code("if(name == \"MarshD\")return (0);");
code("if(name == \"MarshE\")return (0);");
code("if(name == \"MarshF\")return (0);");
code("if(name == \"EgyptianRoadA\")return (0);");
code("if(name == \"GreekRoadA\")return (0);");
code("if(name == \"NorseRoadA\")return (0);");
code("if(name == \"JungleRoadA\")return (0);");
code("if(name == \"PlainRoadA\")return (0);");
code("if(name == \"TundraRoadA\")return (0);");
code("if(name == \"CityTileA\")return (0);");
code("if(name == \"CityTileAtlantis\")return (0);");
code("if(name == \"CityTileAtlantisCoral\")return (0);");
code("if(name == \"CityTileWaterPool\")return (0);");
code("if(name == \"CityTileWaterEdgeA\")return (0);");
code("if(name == \"CityTileWaterEdgeB\")return (0);");
code("if(name == \"CityTileWaterEdgeEndA\")return (0);");
code("if(name == \"CityTileWaterEdgeEndB\")return (0);");
code("if(name == \"CityTileWaterEdgeEndC\")return (0);");
code("if(name == \"CityTileWaterEdgeEndD\")return (0);");
code("if(name == \"CityTileWaterCornerA\")return (0);");
code("if(name == \"CityTileWaterCornerB\")return (0);");
code("if(name == \"CityTileWaterCornerC\")return (0);");
code("if(name == \"CityTileWaterCornerD\")return (0);");
code("if(name == \"HadesBuildable1\")return (0);");
code("if(name == \"HadesBuildable2\")return (0);");
code("if(name == \"ForestFloorPalm\")return (0);");
code("if(name == \"ForestFloorPine\")return (0);");
code("if(name == \"ForestFloorPineSnow\")return (0);");
code("if(name == \"ForestFloorOak\")return (0);");
code("if(name == \"ForestFloorGaia\")return (0);");
code("if(name == \"ForestFloorSavannah\")return (0);");
code("if(name == \"ForestFloorDeadPine\")return (0);");
code("if(name == \"ForestFloorTundra\")return (0);");
code("if(name == \"ForestFloorMarsh\")return (0);");
code("if(name == \"ForestFloorJungle\")return (0);");
code("if(name == \"Water\")return (1);");
code("if(name == \"CliffA\")return (2);");
code("if(name == \"CliffGreekA\")return (2);");
code("if(name == \"CliffEgyptianA\")return (2);");
code("if(name == \"CliffNorseA\")return (2);");
code("if(name == \"CliffJungleA\")return (2);");
code("if(name == \"CliffPlainA\")return (2);");
code("if(name == \"Dam\")return (2);");
code("if(name == \"Hades3\")return (2);");
code("if(name == \"Hades5\")return (2);");
code("if(name == \"Hades6\")return (2);");
code("if(name == \"Hades7\")return (2);");
code("if(name == \"HadesCliff\")return (2);");
code("if(name == \"Hades4\")return (2);");
code("if(name == \"BlackRock\")return (2);");
code("if(name == \"UnderwaterRockA\")return (3);");
code("if(name == \"UnderwaterRockB\")return (3);");
code("if(name == \"UnderwaterRockC\")return (3);");
code("if(name == \"UnderwaterRockD\")return (3);");
code("if(name == \"UnderwaterRockE\")return (3);");
code("if(name == \"UnderwaterRockF\")return (3);");
code("if(name == \"UnderwaterIceA\")return (3);");
code("if(name == \"UnderwaterIceB\")return (3);");
code("if(name == \"UnderwaterIceC\")return (3);");
code("if(name == \"CoralA\")return (3);");
code("if(name == \"CoralB\")return (3);");
code("if(name == \"CoralC\")return (3);");
code("if(name == \"CoralC2\")return (3);");
code("if(name == \"CoralD\")return (3);");
code("if(name == \"CoralE\")return (3);");
code("if(name == \"CoralF\")return (3);");
code("if(name == \"ShorelineSandA\")return (4);");
code("if(name == \"ShorelineAegeanA\")return (4);");
code("if(name == \"ShorelineAegeanB\")return (4);");
code("if(name == \"ShorelineAegeanC\")return (4);");
code("if(name == \"ShorelineRedSeaA\")return (4);");
code("if(name == \"ShorelineRedSeaB\")return (4);");
code("if(name == \"ShorelineRedSeaC\")return (4);");
code("if(name == \"ShorelineNorwegianA\")return (4);");
code("if(name == \"ShorelineNorwegianB\")return (4);");
code("if(name == \"ShorelineNorwegianC\")return (4);");
code("if(name == \"ShorelineMediterraneanA\")return (4);");
code("if(name == \"ShorelineMediterraneanB\")return (4);");
code("if(name == \"ShorelineMediterraneanC\")return (4);");
code("if(name == \"ShorelineMediterraneanD\")return (4);");
code("if(name == \"ShorelineAtlanticA\")return (4);");
code("if(name == \"ShorelineAtlanticB\")return (4);");
code("if(name == \"ShorelineAtlanticC\")return (4);");
code("if(name == \"ShorelineTundraA\")return (4);");
code("if(name == \"ShorelineTundraB\")return (4);");
code("if(name == \"ShorelineTundraC\")return (4);");
code("if(name == \"ShorelineTundraD\")return (4);");
code("if(name == \"ShorelineJungleA\")return (4);");
code("if(name == \"ShorelineJungleB\")return (4);");
code("if(name == \"ShorelineJungleC\")return (4);");
code("if(name == \"ShorelinePlainA\")return (4);");
code("if(name == \"ShorelinePlainB\")return (4);");
code("if(name == \"ShorelinePlainC\")return (4);");
code("if(name == \"ShorelinePlainD\")return (4);");
code("if(name == \"RiverSandyA\")return (4);");
code("if(name == \"RiverSandyB\")return (4);");
code("if(name == \"RiverSandyC\")return (4);");
code("if(name == \"RiverSandyShallowA\")return (4);");
code("if(name == \"RiverGrassyA\")return (4);");
code("if(name == \"RiverGrassyB\")return (4);");
code("if(name == \"RiverGrassyC\")return (4);");
code("if(name == \"RiverIcyA\")return (4);");
code("if(name == \"RiverIcyB\")return (4);");
code("if(name == \"RiverIcyC\")return (4);");
code("if(name == \"RiverMarshA\")return (4);");
code("if(name == \"RiverMarshB\")return (4);");
code("if(name == \"RiverMarshC\")return (4);");
code("if(name == \"IceA\")return (5);");
code("if(name == \"IceB\")return (5);");
code("if(name == \"IceC\")return (5);");
code("if(name == \"MiningGround\")return (5);");
code("if(name == \"Black\")return (5);");
code("if(name == \"Hades1\")return (5);");
code("if(name == \"Hades2\")return (5);");
code("if(name == \"Hades4Passable\")return (5);");
code("if(name == \"Hades8\")return (5);");
code("if(name == \"Hades9\")return (5);");
code("}");
code("int getTerrainSubType(string name = \"\"){");
code("if(name == \"GrassA\")return (0);");
code("if(name == \"GrassB\")return (1);");
code("if(name == \"GrassDirt25\")return (2);");
code("if(name == \"GrassDirt50\")return (3);");
code("if(name == \"GrassDirt75\")return (4);");
code("if(name == \"CliffGreekB\")return (5);");
code("if(name == \"GreekRoad Burnt\")return (6);");
code("if(name == \"GreekRoad BurntB\")return (7);");
code("if(name == \"GaiaCreepA\")return (8);");
code("if(name == \"GaiaCreepASnow\")return (9);");
code("if(name == \"GaiaCreepASand\")return (10);");
code("if(name == \"GaiaCreepB\")return (11);");
code("if(name == \"GaiaCreepBorder\")return (12);");
code("if(name == \"GaiaCreepBorderSnow\")return (13);");
code("if(name == \"GaiaCreepBorderSand\")return (14);");
code("if(name == \"SavannahA\")return (15);");
code("if(name == \"SavannahB\")return (16);");
code("if(name == \"SavannahC\")return (17);");
code("if(name == \"SavannahD\")return (18);");
code("if(name == \"JungleA\")return (19);");
code("if(name == \"JungleB\")return (20);");
code("if(name == \"JungleDirt25\")return (21);");
code("if(name == \"JungleDirt50\")return (22);");
code("if(name == \"JungleDirt75\")return (23);");
code("if(name == \"CliffJungleB\")return (24);");
code("if(name == \"PlainA\")return (25);");
code("if(name == \"PlainB\")return (26);");
code("if(name == \"PlainDirt25\")return (27);");
code("if(name == \"PlainDirt50\")return (28);");
code("if(name == \"PlainDirt75\")return (29);");
code("if(name == \"CliffPlainB\")return (30);");
code("if(name == \"DirtA\")return (31);");
code("if(name == \"DirtB\")return (32);");
code("if(name == \"DirtC\")return (33);");
code("if(name == \"SandA\")return (34);");
code("if(name == \"SandB\")return (35);");
code("if(name == \"SandC\")return (36);");
code("if(name == \"SandD\")return (37);");
code("if(name == \"CliffEgyptianB\")return (38);");
code("if(name == \"SandDirt50\")return (39);");
code("if(name == \"SandDirt50b\")return (40);");
code("if(name == \"SnowA\")return (41);");
code("if(name == \"SnowB\")return (42);");
code("if(name == \"SnowGrass25\")return (43);");
code("if(name == \"SnowGrass50\")return (44);");
code("if(name == \"SnowGrass75\")return (45);");
code("if(name == \"SnowSand25\")return (46);");
code("if(name == \"SnowSand50\")return (47);");
code("if(name == \"SnowSand75\")return (48);");
code("if(name == \"CliffNorseB\")return (49);");
code("if(name == \"OlympusA\")return (50);");
code("if(name == \"OlympusB\")return (51);");
code("if(name == \"OlympusC\")return (52);");
code("if(name == \"OlympusTile\")return (53);");
code("if(name == \"TundraGrassA\")return (54);");
code("if(name == \"TundraGrassB\")return (55);");
code("if(name == \"TundraRockA\")return (56);");
code("if(name == \"TundraRockB\")return (57);");
code("if(name == \"MarshA\")return (58);");
code("if(name == \"MarshB\")return (59);");
code("if(name == \"MarshC\")return (60);");
code("if(name == \"MarshD\")return (61);");
code("if(name == \"MarshE\")return (62);");
code("if(name == \"MarshF\")return (63);");
code("if(name == \"EgyptianRoadA\")return (64);");
code("if(name == \"GreekRoadA\")return (65);");
code("if(name == \"NorseRoadA\")return (66);");
code("if(name == \"JungleRoadA\")return (67);");
code("if(name == \"PlainRoadA\")return (68);");
code("if(name == \"TundraRoadA\")return (69);");
code("if(name == \"CityTileA\")return (70);");
code("if(name == \"CityTileAtlantis\")return (71);");
code("if(name == \"CityTileAtlantisCoral\")return (72);");
code("if(name == \"CityTileWaterPool\")return (73);");
code("if(name == \"CityTileWaterEdgeA\")return (74);");
code("if(name == \"CityTileWaterEdgeB\")return (75);");
code("if(name == \"CityTileWaterEdgeEndA\")return (76);");
code("if(name == \"CityTileWaterEdgeEndB\")return (77);");
code("if(name == \"CityTileWaterEdgeEndC\")return (78);");
code("if(name == \"CityTileWaterEdgeEndD\")return (79);");
code("if(name == \"CityTileWaterCornerA\")return (80);");
code("if(name == \"CityTileWaterCornerB\")return (81);");
code("if(name == \"CityTileWaterCornerC\")return (82);");
code("if(name == \"CityTileWaterCornerD\")return (83);");
code("if(name == \"HadesBuildable1\")return (84);");
code("if(name == \"HadesBuildable2\")return (85);");
code("if(name == \"ForestFloorPalm\")return (86);");
code("if(name == \"ForestFloorPine\")return (87);");
code("if(name == \"ForestFloorPineSnow\")return (88);");
code("if(name == \"ForestFloorOak\")return (89);");
code("if(name == \"ForestFloorGaia\")return (90);");
code("if(name == \"ForestFloorSavannah\")return (91);");
code("if(name == \"ForestFloorDeadPine\")return (92);");
code("if(name == \"ForestFloorTundra\")return (93);");
code("if(name == \"ForestFloorMarsh\")return (94);");
code("if(name == \"ForestFloorJungle\")return (95);");
code("if(name == \"Water\")return (0);");
code("if(name == \"CliffA\")return (0);");
code("if(name == \"CliffGreekA\")return (1);");
code("if(name == \"CliffEgyptianA\")return (2);");
code("if(name == \"CliffNorseA\")return (3);");
code("if(name == \"CliffJungleA\")return (4);");
code("if(name == \"CliffPlainA\")return (5);");
code("if(name == \"Dam\")return (6);");
code("if(name == \"Hades3\")return (7);");
code("if(name == \"Hades5\")return (8);");
code("if(name == \"Hades6\")return (9);");
code("if(name == \"Hades7\")return (10);");
code("if(name == \"HadesCliff\")return (11);");
code("if(name == \"Hades4\")return (12);");
code("if(name == \"BlackRock\")return (13);");
code("if(name == \"UnderwaterRockA\")return (0);");
code("if(name == \"UnderwaterRockB\")return (1);");
code("if(name == \"UnderwaterRockC\")return (2);");
code("if(name == \"UnderwaterRockD\")return (3);");
code("if(name == \"UnderwaterRockE\")return (4);");
code("if(name == \"UnderwaterRockF\")return (5);");
code("if(name == \"UnderwaterIceA\")return (6);");
code("if(name == \"UnderwaterIceB\")return (7);");
code("if(name == \"UnderwaterIceC\")return (8);");
code("if(name == \"CoralA\")return (9);");
code("if(name == \"CoralB\")return (10);");
code("if(name == \"CoralC\")return (11);");
code("if(name == \"CoralC2\")return (12);");
code("if(name == \"CoralD\")return (13);");
code("if(name == \"CoralE\")return (14);");
code("if(name == \"CoralF\")return (15);");
code("if(name == \"ShorelineSandA\")return (0);");
code("if(name == \"ShorelineAegeanA\")return (1);");
code("if(name == \"ShorelineAegeanB\")return (2);");
code("if(name == \"ShorelineAegeanC\")return (3);");
code("if(name == \"ShorelineRedSeaA\")return (4);");
code("if(name == \"ShorelineRedSeaB\")return (5);");
code("if(name == \"ShorelineRedSeaC\")return (6);");
code("if(name == \"ShorelineNorwegianA\")return (7);");
code("if(name == \"ShorelineNorwegianB\")return (8);");
code("if(name == \"ShorelineNorwegianC\")return (9);");
code("if(name == \"ShorelineMediterraneanA\")return (10);");
code("if(name == \"ShorelineMediterraneanB\")return (11);");
code("if(name == \"ShorelineMediterraneanC\")return (12);");
code("if(name == \"ShorelineMediterraneanD\")return (13);");
code("if(name == \"ShorelineAtlanticA\")return (14);");
code("if(name == \"ShorelineAtlanticB\")return (15);");
code("if(name == \"ShorelineAtlanticC\")return (16);");
code("if(name == \"ShorelineTundraA\")return (17);");
code("if(name == \"ShorelineTundraB\")return (18);");
code("if(name == \"ShorelineTundraC\")return (19);");
code("if(name == \"ShorelineTundraD\")return (20);");
code("if(name == \"ShorelineJungleA\")return (21);");
code("if(name == \"ShorelineJungleB\")return (22);");
code("if(name == \"ShorelineJungleC\")return (23);");
code("if(name == \"ShorelinePlainA\")return (24);");
code("if(name == \"ShorelinePlainB\")return (25);");
code("if(name == \"ShorelinePlainC\")return (26);");
code("if(name == \"ShorelinePlainD\")return (27);");
code("if(name == \"RiverSandyA\")return (28);");
code("if(name == \"RiverSandyB\")return (29);");
code("if(name == \"RiverSandyC\")return (30);");
code("if(name == \"RiverSandyShallowA\")return (31);");
code("if(name == \"RiverGrassyA\")return (32);");
code("if(name == \"RiverGrassyB\")return (33);");
code("if(name == \"RiverGrassyC\")return (34);");
code("if(name == \"RiverIcyA\")return (35);");
code("if(name == \"RiverIcyB\")return (36);");
code("if(name == \"RiverIcyC\")return (37);");
code("if(name == \"RiverMarshA\")return (38);");
code("if(name == \"RiverMarshB\")return (39);");
code("if(name == \"RiverMarshC\")return (40);");
code("if(name == \"IceA\")return (0);");
code("if(name == \"IceB\")return (1);");
code("if(name == \"IceC\")return (2);");
code("if(name == \"MiningGround\")return (3);");
code("if(name == \"Black\")return (4);");
code("if(name == \"Hades1\")return (5);");
code("if(name == \"Hades2\")return (6);");
code("if(name == \"Hades4Passable\")return (7);");
code("if(name == \"Hades8\")return (8);");
code("if(name == \"Hades9\")return (9);");
code("}");
code("void grantGodPowerNoRechargeNextPosition(int p = 0, string power = \"\", int count = 0) {");
code("for(tempPowerTech = -1; > 1){}");
code("for(tempPosition = -1; > 1){}");
code("if(power==\"Animal Magnetism\")tempPowerTech=227;");
code("if(power==\"Audrey\")tempPowerTech=407;");
code("if(power==\"Barrage\")tempPowerTech=546;");
code("if(power==\"Blessing of Zeus\")tempPowerTech=351;");
code("if(power==\"Bolt\")tempPowerTech=221;");
code("if(power==\"Bronze\")tempPowerTech=175;");
code("if(power==\"Bronze XP05\")tempPowerTech=457;");
code("if(power==\"Call to Arms\")tempPowerTech=547;");
code("if(power==\"Cease Fire\")tempPowerTech=147;");
code("if(power==\"Cease Fire Nomad\")tempPowerTech=376;");
code("if(power==\"Change Caladria\")tempPowerTech=464;");
code("if(power==\"Change Chimera\")tempPowerTech=463;");
code("if(power==\"Change Cyclops\")tempPowerTech=462;");
code("if(power==\"Change Hydra\")tempPowerTech=467;");
code("if(power==\"Change Manticore\")tempPowerTech=465;");
code("if(power==\"Change Nemean\")tempPowerTech=466;");
code("if(power==\"Chaos\")tempPowerTech=409;");
code("if(power==\"Chicken Storm\")tempPowerTech=388;");
code("if(power==\"Citadel\")tempPowerTech=232;");
code("if(power==\"Create Gold\")tempPowerTech=84;");
code("if(power==\"Curse\")tempPowerTech=229;");
code("if(power==\"Earth Dragon\")tempPowerTech=557;");
code("if(power==\"Earthquake\")tempPowerTech=239;");
code("if(power==\"Eclipse\")tempPowerTech=214;");
code("if(power==\"Examination\")tempPowerTech=550;");
code("if(power==\"Flaming Weapons\")tempPowerTech=223;");
code("if(power==\"Flood\")tempPowerTech=555;");
code("if(power==\"Flood Weak\")tempPowerTech=556;");
code("if(power==\"Forest Fire\")tempPowerTech=248;");
code("if(power==\"Forest Fire SPC\")tempPowerTech=594;");
code("if(power==\"Frost\")tempPowerTech=57;");
code("if(power==\"Gaia Forest\")tempPowerTech=418;");
code("if(power==\"Gaia Forest SPC\")tempPowerTech=505;");
code("if(power==\"Geyser\")tempPowerTech=552;");
code("if(power==\"Goatunheim\")tempPowerTech=391;");
code("if(power==\"Great Hunt\")tempPowerTech=146;");
code("if(power==\"Healing Spring\")tempPowerTech=228;");
code("if(power==\"Heroize\")tempPowerTech=439;");
code("if(power==\"Hesperides\")tempPowerTech=436;");
code("if(power==\"Implode\")tempPowerTech=442;");
code("if(power==\"Inferno\")tempPowerTech=558;");
code("if(power==\"Journey\")tempPowerTech=548;");
code("if(power==\"Lightning Storm\")tempPowerTech=42;");
code("if(power==\"Locust Swarm\")tempPowerTech=43;");
code("if(power==\"Meteor\")tempPowerTech=61;");
code("if(power==\"Nidhogg\")tempPowerTech=235;");
code("if(power==\"Pestilence\")tempPowerTech=249;");
code("if(power==\"Plenty\")tempPowerTech=236;");
code("if(power==\"Prosperity\")tempPowerTech=211;");
code("if(power==\"Ragnorok\")tempPowerTech=234;");
code("if(power==\"Rain\")tempPowerTech=156;");
code("if(power==\"Recreation\")tempPowerTech=543;");
code("if(power==\"Restoration\")tempPowerTech=134;");
code("if(power==\"Reverse Time\")tempPowerTech=406;");
code("if(power==\"Reverse Wonder\")tempPowerTech=434;");
code("if(power==\"Sandstorm\")tempPowerTech=231;");
code("if(power==\"Seed of Gaia\")tempPowerTech=485;");
code("if(power==\"Sentinel\")tempPowerTech=230;");
code("if(power==\"Serpents\")tempPowerTech=226;");
code("if(power==\"Skeleton Power\")tempPowerTech=129;");
code("if(power==\"Snow Storm\")tempPowerTech=172;");
code("if(power==\"Son of Osiris\")tempPowerTech=237;");
code("if(power==\"SPCLightning Storm\")tempPowerTech=468;");
code("if(power==\"SPCMeteor\")tempPowerTech=334;");
code("if(power==\"Spiders\")tempPowerTech=438;");
code("if(power==\"Spy\")tempPowerTech=222;");
code("if(power==\"Tartarian Gate\")tempPowerTech=419;");
code("if(power==\"Timber Harvest\")tempPowerTech=545;");
code("if(power==\"TitanGate\")tempPowerTech=444;");
code("if(power==\"Tornado\")tempPowerTech=44;");
code("if(power==\"Tornado XP05\")tempPowerTech=458;");
code("if(power==\"Traitors\")tempPowerTech=408;");
code("if(power==\"Traitors SPC\")tempPowerTech=491;");
code("if(power==\"Tremor\")tempPowerTech=414;");
code("if(power==\"Tsunami\")tempPowerTech=598;");
code("if(power==\"Undermine\")tempPowerTech=152;");
code("if(power==\"Underworld Passage\")tempPowerTech=133;");
code("if(power==\"Uproot\")tempPowerTech=553;");
code("if(power==\"Uproot SPC\")tempPowerTech=554;");
code("if(power==\"Vision\")tempPowerTech=220;");
code("if(power==\"Volcano\")tempPowerTech=410;");
code("if(power==\"Vortex\")tempPowerTech=431;");
code("if(power==\"Walking Berry Bushes\")tempPowerTech=389;");
code("if(power==\"Walking Woods\")tempPowerTech=233;");
code("if(power==\"Water Damage\")tempPowerTech=615;");
code("if(power==\"Well of Urd\")tempPowerTech=366;");
code("if(power==\"Year of the Goat\")tempPowerTech=544;");
code("if(tempPowerTech>=0){");
code("if(trGetGPData(p, 0, 0) == tempPowerTech)tempPosition=0;");
code("if(trGetGPData(p, 0, 1) == tempPowerTech)tempPosition=1;");
code("if(trGetGPData(p, 0, 2) == tempPowerTech)tempPosition=2;");
code("if(trGetGPData(p, 0, 3) == tempPowerTech)tempPosition=3;");
code("if(trGetGPData(p, 0, 4) == tempPowerTech)tempPosition=4;");
code("if(tempPosition>=0){");
code("trSetGPData(p, 5, tempPosition, 0 - trGetGPData(p, 5, tempPosition));");
code("trSetGPData(p, 1, tempPosition, count);");
code("trSetGPData(p, 2, tempPosition, 0 - trGetGPData(p, 2, tempPosition));");
code("} else {");
code("if((trGetGPData(p, 1, 0) > 0 || trGetGPData(p, 2, 0) > 0) == false){");
code("tempPosition=0;");
code("} else if((trGetGPData(p, 1, 1) > 0 || trGetGPData(p, 2, 1) > 0) == false){");
code("tempPosition=1;");
code("} else if((trGetGPData(p, 1, 2) > 0 || trGetGPData(p, 2, 2) > 0) == false){");
code("tempPosition=2;");
code("} else {");
code("tempPosition=3;");
code("}");
code("trTechGodPowerAtPosition(p, power, 0, tempPosition + 1);");
code("trSetGPData(p, 5, tempPosition, 0 - trGetGPData(p, 5, tempPosition));");
code("trSetGPData(p, 1, tempPosition, count - trGetGPData(p, 1, tempPosition) + trGetGPData(p, 2, tempPosition));");
code("trSetGPData(p, 2, tempPosition, 0 - trGetGPData(p, 2, tempPosition));");
code("}");
code("}");
code("}");
code("void GPSetRechargeTime(int p = 0, string power =\"\", int time = 1000) {");
code("for(tempPowerTech = -1; > 1){}");
code("for(tempPosition = -1; > 1){}");
code("if(power==\"Animal Magnetism\")tempPowerTech=227;");
code("if(power==\"Audrey\")tempPowerTech=407;");
code("if(power==\"Barrage\")tempPowerTech=546;");
code("if(power==\"Blessing of Zeus\")tempPowerTech=351;");
code("if(power==\"Bolt\")tempPowerTech=221;");
code("if(power==\"Bronze\")tempPowerTech=175;");
code("if(power==\"Bronze XP05\")tempPowerTech=457;");
code("if(power==\"Call to Arms\")tempPowerTech=547;");
code("if(power==\"Cease Fire\")tempPowerTech=147;");
code("if(power==\"Cease Fire Nomad\")tempPowerTech=376;");
code("if(power==\"Change Caladria\")tempPowerTech=464;");
code("if(power==\"Change Chimera\")tempPowerTech=463;");
code("if(power==\"Change Cyclops\")tempPowerTech=462;");
code("if(power==\"Change Hydra\")tempPowerTech=467;");
code("if(power==\"Change Manticore\")tempPowerTech=465;");
code("if(power==\"Change Nemean\")tempPowerTech=466;");
code("if(power==\"Chaos\")tempPowerTech=409;");
code("if(power==\"Chicken Storm\")tempPowerTech=388;");
code("if(power==\"Citadel\")tempPowerTech=232;");
code("if(power==\"Create Gold\")tempPowerTech=84;");
code("if(power==\"Curse\")tempPowerTech=229;");
code("if(power==\"Earth Dragon\")tempPowerTech=557;");
code("if(power==\"Earthquake\")tempPowerTech=239;");
code("if(power==\"Eclipse\")tempPowerTech=214;");
code("if(power==\"Examination\")tempPowerTech=550;");
code("if(power==\"Flaming Weapons\")tempPowerTech=223;");
code("if(power==\"Flood\")tempPowerTech=555;");
code("if(power==\"Flood Weak\")tempPowerTech=556;");
code("if(power==\"Forest Fire\")tempPowerTech=248;");
code("if(power==\"Forest Fire SPC\")tempPowerTech=594;");
code("if(power==\"Frost\")tempPowerTech=57;");
code("if(power==\"Gaia Forest\")tempPowerTech=418;");
code("if(power==\"Gaia Forest SPC\")tempPowerTech=505;");
code("if(power==\"Geyser\")tempPowerTech=552;");
code("if(power==\"Goatunheim\")tempPowerTech=391;");
code("if(power==\"Great Hunt\")tempPowerTech=146;");
code("if(power==\"Healing Spring\")tempPowerTech=228;");
code("if(power==\"Heroize\")tempPowerTech=439;");
code("if(power==\"Hesperides\")tempPowerTech=436;");
code("if(power==\"Implode\")tempPowerTech=442;");
code("if(power==\"Inferno\")tempPowerTech=558;");
code("if(power==\"Journey\")tempPowerTech=548;");
code("if(power==\"Lightning Storm\")tempPowerTech=42;");
code("if(power==\"Locust Swarm\")tempPowerTech=43;");
code("if(power==\"Meteor\")tempPowerTech=61;");
code("if(power==\"Nidhogg\")tempPowerTech=235;");
code("if(power==\"Pestilence\")tempPowerTech=249;");
code("if(power==\"Plenty\")tempPowerTech=236;");
code("if(power==\"Prosperity\")tempPowerTech=211;");
code("if(power==\"Ragnorok\")tempPowerTech=234;");
code("if(power==\"Rain\")tempPowerTech=156;");
code("if(power==\"Recreation\")tempPowerTech=543;");
code("if(power==\"Restoration\")tempPowerTech=134;");
code("if(power==\"Reverse Time\")tempPowerTech=406;");
code("if(power==\"Reverse Wonder\")tempPowerTech=434;");
code("if(power==\"Sandstorm\")tempPowerTech=231;");
code("if(power==\"Seed of Gaia\")tempPowerTech=485;");
code("if(power==\"Sentinel\")tempPowerTech=230;");
code("if(power==\"Serpents\")tempPowerTech=226;");
code("if(power==\"Skeleton Power\")tempPowerTech=129;");
code("if(power==\"Snow Storm\")tempPowerTech=172;");
code("if(power==\"Son of Osiris\")tempPowerTech=237;");
code("if(power==\"SPCLightning Storm\")tempPowerTech=468;");
code("if(power==\"SPCMeteor\")tempPowerTech=334;");
code("if(power==\"Spiders\")tempPowerTech=438;");
code("if(power==\"Spy\")tempPowerTech=222;");
code("if(power==\"Tartarian Gate\")tempPowerTech=419;");
code("if(power==\"Timber Harvest\")tempPowerTech=545;");
code("if(power==\"TitanGate\")tempPowerTech=444;");
code("if(power==\"Tornado\")tempPowerTech=44;");
code("if(power==\"Tornado XP05\")tempPowerTech=458;");
code("if(power==\"Traitors\")tempPowerTech=408;");
code("if(power==\"Traitors SPC\")tempPowerTech=491;");
code("if(power==\"Tremor\")tempPowerTech=414;");
code("if(power==\"Tsunami\")tempPowerTech=598;");
code("if(power==\"Undermine\")tempPowerTech=152;");
code("if(power==\"Underworld Passage\")tempPowerTech=133;");
code("if(power==\"Uproot\")tempPowerTech=553;");
code("if(power==\"Uproot SPC\")tempPowerTech=554;");
code("if(power==\"Vision\")tempPowerTech=220;");
code("if(power==\"Volcano\")tempPowerTech=410;");
code("if(power==\"Vortex\")tempPowerTech=431;");
code("if(power==\"Walking Berry Bushes\")tempPowerTech=389;");
code("if(power==\"Walking Woods\")tempPowerTech=233;");
code("if(power==\"Water Damage\")tempPowerTech=615;");
code("if(power==\"Well of Urd\")tempPowerTech=366;");
code("if(power==\"Year of the Goat\")tempPowerTech=544;");
code("if(tempPowerTech>=0){");
code("if(trGetGPData(p, 0, 0) == tempPowerTech)tempPosition=0;");
code("if(trGetGPData(p, 0, 1) == tempPowerTech)tempPosition=1;");
code("if(trGetGPData(p, 0, 2) == tempPowerTech)tempPosition=2;");
code("if(trGetGPData(p, 0, 3) == tempPowerTech)tempPosition=3;");
code("if(trGetGPData(p, 0, 4) == tempPowerTech)tempPosition=4;");
code("if(tempPosition>=0){");
code("if(false){");
code("trSetGPData(p, 5, tempPosition, time);");
code("} else {");
code("trSetGPData(p, 5, tempPosition, time - trGetGPData(p, 5, tempPosition));");
code("}");
code("}");
code("}");
code("}");
code("void refreshPassability(){");
code("trPaintTerrain(0, 0, 0, 0, trGetTerrainType(0, 0), trGetTerrainSubType(0, 0), true);");
code("}");
code("void characterDialog(string character = \"\", string message = \"\", string portrait = \"\"){");
code("trSoundPlayFN(\"\",\"1\",-1,\"\"+character+\":\"+message,portrait);");
code("}");
code("void modifyProtounitAbsolute(string protounit = \"\", int p = 0, int field = 0, float value = 0.0){");
code("if(field == 6){");
code("trModifyProtounit(protounit, p, field, -9999999999999999999.0);");
code("trModifyProtounit(protounit, p, field, value);");
code("} else if(field == 5 || field == 7 || field == 10 || field == 13){");
code("trModifyProtounit(protounit, p, field, 2147483648.0);");
code("trModifyProtounit(protounit, p, field, 2147483648.0);");
code("trModifyProtounit(protounit, p, field, value);");
code("} else {");
code("trModifyProtounit(protounit, p, field, 9999999999999999999.0);");
code("trModifyProtounit(protounit, p, field, -9999999999999999999.0);");
code("trModifyProtounit(protounit, p, field, value);");
code("}");
code("}");
code("void paintShopSquare(int posX = 0, int PosZ = 0, string terrain = \"\"){");
code("int terrainType = getTerrainType(terrain);");
code("int terrainSubType = getTerrainSubType(terrain);");
code("trPaintTerrain(posX+1, PosZ+1, posX+1, PosZ+1, 0, 80, false);");
code("trPaintTerrain(posX+1, PosZ, posX+1, PosZ, 0, 74, false);");
code("trPaintTerrain(posX+1, PosZ-1, posX+1, PosZ-1, 0, 81, false);");
code("trPaintTerrain(posX, PosZ-1, posX, PosZ-1, 0, 75, false);");
code("trPaintTerrain(posX-1, PosZ-1, posX-1, PosZ-1, 0, 82, false);");
code("trPaintTerrain(posX-1, PosZ, posX-1, PosZ, 0, 74, false);");
code("trPaintTerrain(posX-1, PosZ+1, posX-1, PosZ+1, 0, 83, false);");
code("trPaintTerrain(posX, PosZ+1, posX, PosZ+1, 0, 75, false);");
code("trPaintTerrain(posX, PosZ, posX, PosZ, terrainType, terrainSubType, false);");
code("}");
code("void CounterShow(int xx = 0){");
code("string colourString = \"<color={PlayerColor(\"+xx+\")}>\";");
code("string incomeString = \"Income: \"+1*trQuestVarGet(\"P\"+xx+\"Income\")+\" | Lives: \"+1*trQuestVarGet(\"P\"+xx+\"Lives\");");
code("string LivesString = \"\"+1*trQuestVarGet(\"P\"+xx+\"Lives\")+\" | \"+1*trQuestVarGet(\"P\"+xx+\"Lives\");");
code("string iconString = \"<icon=(16)(icons/icon resource wood)>\";");
code("trSetCounterDisplay(colourString+incomeString);");
code("}");
code("void ColouredTimer(int c = 0, string text = \"\", int time = 0, string name = \"countdown\", int eventID = -1){");
code("string colourString = \"<color={PlayerColor(\"+c+\")}>\";");
code("trCounterAddTime(name, time, 0, colourString + text, eventID);");
code("}");
code("void ColouredIconTimer(int c = 0, string icon =\"\", string text = \"\", int time = 0,");
code("string name = \"countdown\", int eventID = -1){");
code("string colourString = \"<color={PlayerColor(\"+c+\")}>\";");
code("string iconString = \"<icon=(20)(\"+icon+\")>\";");
code("trCounterAddTime(name, time, 0, colourString + iconString + text, eventID);");
code("}");
code("void OverlayTextPlayerColor(int p = 0){");
code("if(p == 0)trOverlayTextColour(153, 102, 0);");
code("if(p == 1)trOverlayTextColour(50, 50, 255);");
code("if(p == 2)trOverlayTextColour(255, 50, 50);");
code("if(p == 3)trOverlayTextColour(0, 150, 0);");
code("if(p == 4)trOverlayTextColour(50, 235, 255);");
code("if(p == 5)trOverlayTextColour(223, 52, 238);");
code("if(p == 6)trOverlayTextColour(255, 255, 0);");
code("if(p == 7)trOverlayTextColour(255, 102, 0);");
code("if(p == 8)trOverlayTextColour(128, 0, 64);");
code("if(p == 9)trOverlayTextColour(50, 255, 50);");
code("if(p == 10)trOverlayTextColour(179, 251, 186);");
code("if(p == 11)trOverlayTextColour(80, 80, 80);");
code("if(p == 12)trOverlayTextColour(255, 0, 102);");
code("}");
code("void UnitCreate(int player = 0, string protounitname = \"\", int xx = 0, int zz = 0, int xheadingx = 0){");
code("trQuestVarSet(\"CreatingU\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Dwarf\", 1, xx, 0, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"CreatingU\"));");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("}");
code("void FloatingUnit(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1){");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Dwarf\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"1,0,0,0,0\");");
code("}");
code("void FloatingUnitAnim(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\"){");
code("trArmyDispatch(\"0,0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Dwarf\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("}");
code("void FloatingUnitAnimNoLOS(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\"){");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Flying Medic\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("}");
code("void FloatingUnitAnimCiv(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\"){");
code("trArmyDispatch(\"0,0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("trVectorQuestVarGetY(\"V1\") + yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("}");
code("void FloatingUnitAnim4(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\", int p = 0){");
code("trArmyDispatch(\"\"+p+\",0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"\"+p+\",0\", \"Flying Medic\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"\"+p+\",0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),yy,trVectorQuestVarGetZ(\"V1\"));");
code("}");
code("void FloatingUnitAnim5(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\", int p = 0){");
code("trArmyDispatch(\"\"+p+\",0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"\"+p+\",0\", \"Flying Medic\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"\"+p+\",0\", \"Relic\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(xx, yy, zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("}");
code("void FloatingUnitAnim2(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\"){");
code("trArmyDispatch(\"0,0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Flying Medic\", 1, 50, yy, 50, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Relic\", 1, 50, yy, 50, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("trVectorQuestVarGetY(\"V1\") + yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("}");
code("void FloatingUnitAnimIdle(string protounitname=\"\", int xx = 0, int yy = 0, int zz = 0, int xheadingx = 0,");
code("float scalex = 1, float scaley = 1, float scalez = 1, string anim=\"0,0,0,0,0\", int animtype = 2){");
code("trArmyDispatch(\"0,0\", \"Revealer\", 1, xx, yy, zz, xheadingx, true);");
code("trQuestVarSet(\"BuildID\", trQuestVarGet(\"BuildID\") + 1);");
code("trQuestVarSet(\"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVHero\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Flying Medic\", 1, xx, yy, zz, xheadingx, true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitChangeProtoUnit(\"Amanra\");");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"));");
code("trUnitOverrideAnimation(animtype, 0, true, true, -1, 0);");
code("trQuestVarSet(\"QVRelic\"+(1*trQuestVarGet(\"BuildID\"))+\"\", trGetNextUnitScenarioNameNumber());");
code("trQuestVarSet(\"QVRelic\", trGetNextUnitScenarioNameNumber());");
code("trArmyDispatch(\"0,0\", \"Ajax\", 1, xx, yy, zz, trQuestVarGet(\"Heading\"+(1*trQuestVarGet(\"Build\"))+\"\"), true);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trUnitOverrideAnimation(animtype, 0, true, true, -1, 0);");
code("trMutateSelected(kbGetProtoUnitID(\"Relic\"));");
code("trQuestVarCopy(\"QVHero\", \"QVHero\"+(1*trQuestVarGet(\"BuildID\"))+\"\");");
code("trVectorQuestVarSet(\"V1\", kbGetBlockPosition(\"0\"));");
code("trVectorQuestVarSet(\"V1\", xsVectorSet(trVectorQuestVarGetX(\"V1\") + xx,");
code("yy,trVectorQuestVarGetZ(\"V1\") + zz));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"));");
code("trImmediateUnitGarrison(\"\"+(1*trQuestVarGet(\"QVHero\"))+\"\");");
code("trMutateSelected(kbGetProtoUnitID(\"\"+protounitname+\"\"));");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trMutateSelected(kbGetProtoUnitID(\"Wadjet Spit\"));");
code("trQuestVarSet(\"Build\", trQuestVarGet(\"Build\") - 1);");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVRelic\"), true);");
code("trSetSelectedScale(scalex, scaley, scalez);");
code("trUnitSetAnimationPath(\"\"+anim+\"\");");
code("trUnitSelectClear();");
code("trUnitSelect(\"\"+1*trQuestVarGet(\"QVHero\"), true);");
code("trUnitTeleport(trVectorQuestVarGetX(\"V1\"),trVectorQuestVarGetY(\"V1\"),trVectorQuestVarGetZ(\"V1\"));");
code("}");
code("void activateFlagTimerEnd(int asdf = 1) {");
code("xsEnableRule(\"FlagTimerEnd\");");
code("}");
code("void activatestartcine(int asdf = 2) {");
code("xsEnableRule(\"startcine\");");
code("}");
code("void activatecustomcontent(int asdf = 3) {");
code("xsEnableRule(\"customcontent\");");
code("}");
code("void activateShopLevel2(int asdf = 4) {");
code("xsEnableRule(\"ShopLevel2\");");
code("}");
code("void activateShopLevel3(int asdf = 5) {");
code("xsEnableRule(\"ShopLevel3\");");
code("}");
code("void activateShopLevel4(int asdf = 6) {");
code("xsEnableRule(\"ShopLevel4\");");
code("}");
code("void activateShopLevel5(int asdf = 7) {");
code("xsEnableRule(\"ShopLevel5\");");
code("}");
code("void activateShopLevel6(int asdf = 8) {");
code("xsEnableRule(\"ShopLevel6\");");
code("}");
code("void activateShopLevel7(int asdf = 9) {");
code("xsEnableRule(\"ShopLevel7\");");
code("}");
code("void activateShopLevel8(int asdf = 10) {");
code("xsEnableRule(\"ShopLevel8\");");
code("}");
code("void paintTreesSlow(string terrain = \"\", string tree = \"\", int xmin = 0, int zmin = 0, int xmax = 0, int zmax = 0){");
code("int terrainType = getTerrainType(terrain);");
code("int terrainSubType = getTerrainSubType(terrain);");
code("trPaintTerrain(xmin, zmin, xmax, zmax, terrainType, terrainSubType, false);");
code("for (x=xmax; >= xmin) {");
code("for (z=zmax; >= zmin) {");
code("trQuestVarSetFromRand(\"heading\", 0, 359, true);");
code("trArmyDispatch(\"0,0\", \"Victory Marker\", 1, x*2, 5.00, z*2, 1*trQuestVarGet(\"Heading\"), false);");
code("}");
code("}");
code("trUnitSelectClear();");
code("trUnitSelect(\"0\");");
code("trUnitChangeInArea(0, 0, \"Victory Marker\", tree, 999.0);");
code("}");
code("void trQuestVarModify(string QV = \"\", string Operator = \"\", int number = 0){");
code("if(Operator == \"+\"){");
code("trQuestVarSet(QV, 1*trQuestVarGet(QV) + number);");
code("}");
code("else if(Operator == \"-\"){");
code("trQuestVarSet(QV, 1*trQuestVarGet(QV) - number);");
code("}");
code("else if(Operator == \"*\"){");
code("trQuestVarSet(QV, 1*trQuestVarGet(QV) * number);");
code("}");
code("else if(Operator == \"/\"){");
code("trQuestVarSet(QV, 1*trQuestVarGet(QV) / number);");
code("}");
code("}");
code("void trPaintTerrainCircle(int posX = 0, int PosZ = 0, int irad = 0, int type = 0, int subtype = 0){");
code("for(tempType = -1; > 1){}");
code("for(tempSubType = -1; > 1){}");
code("for(tempMinX = 0; > 1){}");
code("for(tempMinZ = 0; > 1){}");
code("for(tempMaxX = 0; > 1){}");
code("for(tempMaxZ = 0; > 1){}");
code("for(tempX = 0; > 1){}");
code("for(tempZ = 0; > 1){}");
code("for(tempRadiusCheck = 0; > 1){}");
code("for(tempOldContextPlayer = 0; > 1){}");
code("tempMinX = xsMax(0.0 - posX, -1*irad );");
code("tempMinZ = xsMax(0.0 - PosZ, -1*irad );");
code("tempOldContextPlayer = xsGetContextPlayer();");
code("xsSetContextPlayer(0);");
code("tempMaxX = xsMin(kbGetMapXSize() / 2 - posX - 1, irad );");
code("tempMaxZ = xsMin(kbGetMapZSize() / 2 - PosZ - 1, irad );");
code("xsSetContextPlayer(tempOldContextPlayer);");
code("tempRadiusCheck = irad  * irad  + irad ;");
code("for(tempZ = tempMaxZ; >= tempMinZ){");
code("for(tempX = tempMaxX; >= tempMinX){");
code("if(tempRadiusCheck > (tempX*tempX + tempZ*tempZ)){");
code("trPaintTerrain(tempX + posX, tempZ + PosZ, tempX + posX, tempZ + PosZ, type, subtype, false);");
code("}");
code("}");
code("}");
code("}");
code("void trPaintTerrainCircleOutline(int posX = 0, int PosZ = 0, int irad = 0, int type = 0, int subtype = 0){");
code("for(tempType = -1; > 1){}");
code("for(tempSubType = -1; > 1){}");
code("for(tempMinX = 0; > 1){}");
code("for(tempMinZ = 0; > 1){}");
code("for(tempMaxX = 0; > 1){}");
code("for(tempMaxZ = 0; > 1){}");
code("for(tempX = 0; > 1){}");
code("for(tempZ = 0; > 1){}");
code("for(tempRadiusCheck = 0; > 1){}");
code("for(tempOldContextPlayer = 0; > 1){}");
code("tempMinX = xsMax(0.0 - posX, -1*irad );");
code("tempMinZ = xsMax(0.0 - PosZ, -1*irad );");
code("tempOldContextPlayer = xsGetContextPlayer();");
code("xsSetContextPlayer(0);");
code("tempMaxX = xsMin(kbGetMapXSize() / 2 - posX - 1, irad );");
code("tempMaxZ = xsMin(kbGetMapZSize() / 2 - PosZ - 1, irad );");
code("xsSetContextPlayer(tempOldContextPlayer);");
code("tempRadiusCheck = irad  * irad  + irad ;");
code("for(tempZ = tempMaxZ; >= tempMinZ){");
code("for(tempX = tempMaxX; >= tempMinX){");
code("if(tempRadiusCheck <= (tempX*tempX + tempZ*tempZ)){");
code("trPaintTerrain(tempX + posX, tempZ + PosZ, tempX + posX, tempZ + PosZ, type, subtype, false);");
code("}");
code("}");
code("}");
code("}");
code("void replaceCircle(int posX = 0, int PosZ = 0, int radius = 0, string oldTerrain = \"\", string newTerrain = \"\"){");
code("int oldTerrainType = getTerrainType(oldTerrain);");
code("int oldTerrainSubType = getTerrainSubType(oldTerrain);");
code("int newTerrainType = getTerrainType(newTerrain);");
code("int newTerrainSubType = getTerrainSubType(newTerrain);");
code("int tempMinX = xsMax(0.0 - posX, 0.0 - radius);");
code("int tempMinZ = xsMax(0.0 - PosZ, 0.0 - radius);");
code("int tempMaxX = xsMin(200 - posX, radius);");
code("int tempMaxZ = xsMin(200 - PosZ, radius);");
code("int tempRadiusCheck = radius * radius + radius;");
code("for(tempZ = tempMaxZ; >= tempMinZ){");
code("for(tempX = tempMaxX; >= tempMinX){");
code("if(tempRadiusCheck >= (tempX*tempX + tempZ*tempZ)){");
code("int terrainType = trGetTerrainType(tempX + posX, tempZ + PosZ);");
code("int terrainSubType = trGetTerrainSubType(tempX + posX, tempZ + PosZ);");
code("if(terrainType == oldTerrainType && terrainSubType == oldTerrainSubType){");
code("trPaintTerrain(tempX + posX, tempZ + PosZ, tempX + posX, tempZ + PosZ, newTerrainType, newTerrainSubType, false);");
code("}");
code("}");
code("}");
code("}");
code("}");
code("void trPaintElevationCircle(int PosX = 0, int PosZ = 0, int Rad = 0, int Height = 0){");
code("for(tempMinX = 0; > 1){}");
code("for(tempMinZ = 0; > 1){}");
code("for(tempMaxX = 0; > 1){}");
code("for(tempMaxZ = 0; > 1){}");
code("for(tempRadiusCheck = 0; > 1){}");
code("for(tempLocX = 0; > 1){}");
code("for(tempLocZ = 0; > 1){}");
code("for(tempOldContextPlayer = 0; > 1){}");
code("tempMinX = xsMax(0.0 - PosX, -1*Rad);");
code("tempMinZ = xsMax(0.0 - PosZ, -1*Rad);");
code("tempOldContextPlayer = xsGetContextPlayer();");
code("xsSetContextPlayer(0);");
code("tempMaxX = xsMin(kbGetMapXSize() / 2 - PosX, Rad);");
code("tempMaxZ = xsMin(kbGetMapZSize() / 2 - PosZ, Rad);");
code("xsSetContextPlayer(tempOldContextPlayer);");
code("tempRadiusCheck = Rad * Rad + Rad;");
code("if(false){");
code("for(tempZ = tempMaxZ; >= tempMinZ){");
code("for(tempX = tempMaxX; >= tempMinX){");
code("if(tempRadiusCheck > (tempX*tempX + tempZ*tempZ)){");
code("tempLocX = tempX + PosX;");
code("tempLocZ = tempZ + PosZ;");
code("trChangeTerrainHeight(tempLocX, tempLocZ, tempLocX, tempLocZ, trGetTerrainHeight(tempLocX, tempLocZ) + Height, false);");
code("}");
code("}");
code("}");
code("} else {");
code("for(tempZ = tempMaxZ; >= tempMinZ){");
code("for(tempX = tempMaxX; >= tempMinX){");
code("if(tempRadiusCheck >= (tempX*tempX + tempZ*tempZ)){");
code("tempLocX = tempX + PosX;");
code("tempLocZ = tempZ + PosZ;");
code("trChangeTerrainHeight(tempLocX, tempLocZ, tempLocX, tempLocZ, Height, false);");
code("}");
code("}");
code("}");
code("}");
code("}");
code("void CTFPaintBase(float PosX = 0, float PosZ = 0){");
code("trPaintTerrainCircle(PosX/2+7,PosZ/2+8,10,2,13);");
code("trPaintElevationCircle(PosX/2+7,PosZ/2+7,11,5);");
code("}");
code("void CTFBuildBase(int p = 1, float PosX = 0, float PosZ = 0){");
code("trQuestVarSet(\"Base\", trGetNextUnitScenarioNameNumber());");
code("trVectorQuestVarSet(\"P\"+p+\"Base\", xsVectorSet(PosX+15, 5, PosZ+15));");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+14, 0, PosZ+15, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX, 0, PosZ+10, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX, 0, PosZ+15, 90, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX, 0, PosZ+20, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+4, 0, PosZ+24, 135, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+8, 0, PosZ+28, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+13, 0, PosZ+28, 180, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+18, 0, PosZ+28, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+22, 0, PosZ+24, 225, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+26, 0, PosZ+20, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+26, 0, PosZ+15, 270, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+26, 0, PosZ+10, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+22, 0, PosZ+6, 315, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+18, 0, PosZ+2, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+12, 0, PosZ+2, 180, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+8, 0, PosZ+2, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+4, 0, PosZ+6, 45, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+11, 0, PosZ+14, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+11, 0, PosZ+16, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+13, 0, PosZ+14, 0, false);");
code("trArmyDispatch(\"\"+p+\",0\", \"Victory Marker\", 1, PosX+13, 0, PosZ+16, 0, false);");
code("yAddToDatabase(\"BaseBlocks\", \"Base\");");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectClear();");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot8\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Long\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot7\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Gate\");");
code("yAddToDatabase(\"Gates\", \"Base\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot6\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Long\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot5\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Gate\");");
code("yAddToDatabase(\"Gates\", \"Base\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot4\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Long\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot3\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Gate\");");
code("yAddToDatabase(\"Gates\", \"Base\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot2\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Long\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Atlantis Wall Connector\");");
code("trVectorQuestVarSet(\"P\"+p+\"FlagSlot1\", kbGetBlockPosition(\"\"+1*trQuestVarGet(\"Base\")+\"\"));");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Gate\");");
code("yAddToDatabase(\"Gates\", \"Base\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Tower Mirror\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Tower Mirror\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Tower Mirror\");");
code("trUnitSelectClear();");
code("trQuestVarModify(\"Base\", \"+\", 1);");
code("trUnitSelectByQV(\"Base\", false);");
code("trUnitChangeProtoUnit(\"Tower Mirror\");");
code("trUnitSelectClear();");
code("trUnitSelectByID(p);");
code("trUnitTeleport(trVectorQuestVarGetX(\"P\"+p+\"Base\"),");
code("trVectorQuestVarGetY(\"P\"+p+\"Base\"),trVectorQuestVarGetZ(\"P\"+p+\"Base\"));");
code("trUnitChangeProtoUnit(\"Storage Pit\");");
code("}");
code("void setupUnitShop(int slot = 0, string displayname = \"\", string protoname = \"\",");
code("string description = \"\", int cost = 0, int limit = 0) {");
code("trStringQuestVarSet(\"unit\"+slot+\"displayname\", displayname);");
code("trStringQuestVarSet(\"unit\"+slot+\"protoname\", protoname);");
code("trStringQuestVarSet(\"unit\"+slot+\"description\", description);");
code("trQuestVarSet(\"unit\"+slot+\"cost\", cost);");
code("trQuestVarSet(\"unit\"+slot+\"limit\", limit);");
code("}");
code("void setupPowerShop(int slot = 0, string displayname = \"\", string powername = \"\",");
code("string protoname = \"\", string description = \"\", int cost = 0, int idneeded = 0) {");
code("trStringQuestVarSet(\"power\"+slot+\"displayname\", displayname);");
code("trStringQuestVarSet(\"power\"+slot+\"powername\", powername);");
code("trStringQuestVarSet(\"power\"+slot+\"protoname\", protoname);");
code("trStringQuestVarSet(\"power\"+slot+\"description\", description);");
code("trQuestVarSet(\"power\"+slot+\"cost\", cost);");
code("trQuestVarSet(\"power\"+slot+\"id\", idneeded);");
code("}");
code("void playSoundCustom(string BasesoundName = \"\", string CustomsoundName = \"\"){");
code("if(1*trQuestVarGet(\"CustomContent\") == 0){");
code("trSoundPlayPaused(\"\"+BasesoundName+\"\", \"1\", -1, \"\", \"\");");
code("}");
code("else {");
code("trSoundPlayPaused(\"\"+CustomsoundName+\"\", \"1\", -1, \"\", \"\");");
code("}");
code("}");
code("void ColouredIconChat(string colour = \"1,1,1\", string icon = \"\", string chats = \"\"){");
code("trChatSend(0, \"<color=\"+colour+\"><icon=(20)(\"+icon+\")> \"+chats+\"</color>\");");
code("}");
code("void ColouredIconChatToPlayer(int p = 1, string colour = \"1,1,1\", string icon = \"\", string chats = \"\"){");
code("trChatSendToPlayer(0, p, \"<color=\" + colour + \"><icon=(20)(\" + icon + \")> \" + chats + \"</color>\");");
code("}");
code("void PwnPlayer(int p = 0, int v = 0){");
code("trSetPlayerDefeated(p);");
code("OverlayTextPlayerColor(p);");
code("trOverlayText(trStringQuestVarGet(\"p\"+p+\"name\") + \"'s flag has been captured!\", 5.0, 350, 350, 800);");
code("playSound(\"Yeebaagooon\Capture The Flag\Warp.mp3\");");
code("playSound(\"timeshift.wav\");");
code("trCameraShake(5, 0.1);");
code("trPlayerKillAllBuildings(p);");
code("trPlayerKillAllUnits(p);");
code("trUnitSelectClear();");
code("trUnitSelect(\"+p+\");");
code("trUnitChangeProtoUnit(\"Cinematic Block\");");
code("trPlayerGrantResources(v, \"Food\", 1*trPlayerResourceCount(p, \"Food\"));");
code("trPlayerGrantResources(v, \"Wood\", 1*trPlayerResourceCount(p, \"Wood\"));");
code("trPlayerGrantResources(v, \"Gold\", 1*trPlayerResourceCount(p, \"Gold\"));");
code("ColouredIconChatToPlayer(v, \"{PlayerColor(\"+p+\")}\", \"icons\icon resource food\",");
code("\"\"+1*trPlayerResourceCount(p, \"Food\")+\"\");");
code("ColouredIconChatToPlayer(v, \"{PlayerColor(\"+p+\")}\", \"icons\icon resource wood\",");
code("\"\"+1*trPlayerResourceCount(p, \"Wood\")+\"\");");
code("ColouredIconChatToPlayer(v, \"{PlayerColor(\"+p+\")}\", \"icons\icon resource gold\",");
code("\"\"+1*trPlayerResourceCount(p, \"Gold\")+\"\");");
code("trPlayerGrantResources(p, \"Food\", -10000.0);");
code("trPlayerGrantResources(p, \"Wood\", -10000.0);");
code("trPlayerGrantResources(p, \"Gold\", -10000.0);");
code("trPlayerGrantResources(p, \"Favor\", -10000.0);");
code("trQuestVarModify(\"P\"+v+\"FlagsGot\", \"+\", 1);");
code("if(1*trQuestVarGet(\"P\"+v+\"FlagsGot\") < 9){");
code("FloatingUnitAnim4(\"Flag\",");
code("1*trVectorQuestVarGetX(\"P\"+v+\"FlagSlot\"+1*trQuestVarGet(\"P\"+v+\"FlagsGot\")),");
code("1*trVectorQuestVarGetY(\"P\"+v+\"FlagSlot\"+1*trQuestVarGet(\"P\"+v+\"FlagsGot\")),");
code("1*trVectorQuestVarGetZ(\"P\"+v+\"FlagSlot\"+1*trQuestVarGet(\"P\"+v+\"FlagsGot\")),");
code("0, 1, 1, 1, \"0,0,0,0,0\", p);");
code("}");
code("}");
code("void PaintAtlantisArea (int x0 = 0, int z0 = 0, int x1 = 0, int z1 = 0, int fill1 = 0, int fill2 = 0){");
code("trPaintTerrain(x0, z1, x0, z1, 0, 83, false);");
code("trPaintTerrain(x1, z1, x1, z1, 0, 80, false);");
code("trPaintTerrain(x0, z0, x0, z0, 0, 82, false);");
code("trPaintTerrain(x1, z0, x1, z0, 0, 81, false);");
code("trPaintTerrain(x1-1, z1, x0+1, z1, 0, 75, false);");
code("trPaintTerrain(x1-1, z0, x0+1, z0, 0, 75, false);");
code("trPaintTerrain(x1, z1-1, x1, z0+1, 0, 74, false);");
code("trPaintTerrain(x0, z1-1, x0, z0+1, 0, 74, false);");
code("trPaintTerrain(x1-1, z1-1, x0+1, z0+1, fill1, fill2, false);");
code("}");
}
void globals() {
code("int cNumberNonGaiaPlayers = "+cNumberNonGaiaPlayers+";");
}
void terrain() {
}
void setup() {
code("int QuickStart = 0;");
code("string MapVersion = \"Test Version\";");
code("string MapName = \"Zoo Quest.xs\";");
code("rule Initialise");
code("active");
code("highFrequency");
code("runImmediately");
code("{");
code("characterDialog(\"Waiting for everyone to connect.\", \" \", \"icons\special e son of osiris icon 64\");");
code("trUIFadeToColor(0, 0, 0, 0, 10000, false);");
code("trFadeOutAllSounds(0.1);");
code("trFadeOutMusic(0.1);");
code("xsEnableRule(\"WorldBuild\");");
code("if(QuickStart == 0){");
code("}");
code("trBlockAllSounds(true);");
code("trArmyDispatch(\"0,0\", \"Cinematic Block\", 1, 0, 0, 0, 0, false);");
code("for(p = 1; <= cNumberNonGaiaPlayers){");
code("deployLocHeading(0, p*2, \"Victory Marker\", p, 180);");
code("}");
code("trSetFogAndBlackmap(false, false);");
for(p=1; <= cNumberNonGaiaPlayers) {
code("trStringQuestVarSet(\"p"+p+"name\", \""+rmGetPlayerName(p)+"\");");
}
code("xsDisableSelf();");
code("}");
code("rule START");
code("active");
code("highFrequency");
code("{");
code("aiSet(\"NoAI\", 0);");
code("trPlayerKillAllGodPowers(0);");
code("for(p = 1; <= cNumberNonGaiaPlayers){");
code("trSetCivAndCulture(p, 3, 1);");
code("trPlayerGrantResources(p, \"Food\", -10000.0);");
code("trPlayerGrantResources(p, \"Wood\", -10000.0);");
code("trPlayerGrantResources(p, \"Gold\", -10000.0);");
code("trPlayerGrantResources(p, \"Favor\", -10000.0);");
code("trPlayerKillAllGodPowers(p);");
code("modifyProtounitAbsolute(\"Vision Revealer\", p, 2, 24);");
code("modifyProtounitAbsolute(\"Vision Revealer\", p, 8, 999999);");
code("}");
code("trShowImageDialog(\"world a tamarisk tree leaf\", MapName + \" by Yeebaagooon\");");
code("gadgetUnreal(\"ShowImageBox-BordersTop\");");
code("gadgetUnreal(\"ShowImageBox-BordersBottom\");");
code("gadgetUnreal(\"ShowImageBox-BordersLeft\");");
code("gadgetUnreal(\"ShowImageBox-BordersRight\");");
code("gadgetUnreal(\"ShowImageBox-BordersLeftTop\");");
code("gadgetUnreal(\"ShowImageBox-BordersLeftBottom\");");
code("gadgetUnreal(\"ShowImageBox-BordersRightBottom\");");
code("gadgetUnreal(\"ShowImageBox-BordersRightTop\");");
code("gadgetUnreal(\"ShowImageBox-CloseButton\");");
code("pause(0);");
code("characterDialog(\"Initialising map\", \" \", \"icons\special e son of osiris icon 64\");");
code("xsEnableRule(\"load1\");");
code("xsDisableSelf();");
code("}");
code("rule load1");
code("inactive");
code("highFrequency");
code("{");
code("characterDialog(\"Loading map.\", \"\"+MapVersion+\"\", \"icons\special e son of osiris icon 64\");");
code("xsEnableRule(\"load2\");");
code("trBlockAllSounds(false);");
code("xsDisableSelf();");
code("}");
code("rule load2");
code("inactive");
code("highFrequency");
code("{");
code("characterDialog(\"Loading map..\", \"\"+MapVersion+\"\", \"icons\special e son of osiris icon 64\");");
code("xsEnableRule(\"load3\");");
code("xsDisableSelf();");
code("}");
code("rule load3");
code("inactive");
code("highFrequency");
code("{");
code("if((trTime()-cActivationTime) >= 1){");
code("characterDialog(\"Loading map...\", \"\"+MapVersion+\"\", \"icons\special e son of osiris icon 64\");");
code("aiSet(\"NoAI\", 0);");
code("for(p = 1; <= cNumberNonGaiaPlayers){");
code("trPlayerGrantResources(p, \"Food\", -10000.0);");
code("trPlayerGrantResources(p, \"Wood\", -10000.0);");
code("trPlayerGrantResources(p, \"Gold\", -10000.0);");
code("trPlayerGrantResources(p, \"Favor\", -10000.0);");
code("trPlayerKillAllGodPowers(p);");
code("}");
code("xsEnableRule(\"load4\");");
code("xsDisableSelf();");
code("}");
code("}");
code("rule load4");
code("inactive");
code("highFrequency");
code("{");
code("if((trTime()-cActivationTime) >= 1){");
code("trUnblockAllSounds();");
code("trLetterBox(false);");
code("trUIFadeToColor(0,0,0,1000,1,false);");
code("trOverlayTextColour(255, 125, 0);");
code("gadgetUnreal(\"ShowImageBox\");");
code("trOverlayText(MapName, 8.0, 566, 35, 1000);");
code("trSetUnitIdleProcessing(true);");
code("xsDisableSelf();");
code("paintShopSquare(3,3, \"Black\");");
code("UnitCreate(0, \"Hoplite\", 8, 8, 0);");
code("while(cNumberNonGaiaPlayers>=trQuestVarGet(\"PlayerID\")) {");
code("trQuestVarSet(\"PlayerID2\", 0);");
code("while(cNumberNonGaiaPlayers>=trQuestVarGet(\"PlayerID2\")) {");
code("trPlayerSetDiplomacy(trQuestVarGet(\"PlayerID\"), trQuestVarGet(\"PlayerID2\"), \"Enemy\");");
code("trPlayerSetDiplomacy(trQuestVarGet(\"PlayerID2\"), trQuestVarGet(\"PlayerID\"), \"Enemy\");");
code("trQuestVarSet(\"PlayerID2\", trQuestVarGet(\"PlayerID2\")+1);}");
code("trQuestVarSet(\"PlayerID\", trQuestVarGet(\"PlayerID\")+1);}");
code("}");
code("}");
code("rule customcontent");
code("inactive");
code("highFrequency");
code("{");
code("xsDisableSelf();");
code("trQuestVarSet(\"CustomContent\", 1);");
code("}");
}
void techstat() {
code("rule Technologies");
code("inactive");
code("highFrequency");
code("{");
code("for(p = 1; <= cNumberNonGaiaPlayers){");
code("trTechSetStatus(p, 1, 4);");
code("trTechSetStatus(p, 2, 4);");
code("trTechSetStatus(p, 116, 4);");
code("trTechSetStatus(p, 29, 4);");
code("trTechSetStatus(p, 353, 0);");
code("trTechSetStatus(p, 394, 0);");
code("trTechSetStatus(p, 510, 0);");
code("trTechSetStatus(p, 145, 0);");
code("trTechSetStatus(p, 144, 0);");
code("trTechSetStatus(p, 143, 0);");
code("trTechSetStatus(p, 379, 0);");
code("trTechSetStatus(p, 28, 4);");
code("trTechSetStatus(p, 30, 4);");
code("trTechSetStatus(p, 350, 4);");
code("trTechSetStatus(p, 27, 4);");
code("for(n=930; >0) {");
code("trForbidProtounit(p,kbGetProtoUnitName(n));");
code("}");
code("}");
code("xsDisableSelf();");
code("}");
code("rule Stats");
code("inactive");
code("highFrequency");
code("{");
code("trModifyProtounit(\"Dwarf\", 0, 55, 4);");
code("for(p = 1; <= cNumberNonGaiaPlayers){");
code("trModifyProtounit(\"Dwarf\", p, 55, 4);");
code("modifyProtounitAbsolute(\"Atlantis Wall Long\", p, 0, 10000000);");
code("modifyProtounitAbsolute(\"Atlantis Wall Connector\", p, 0, 10000000);");
code("modifyProtounitAbsolute(\"Tower Mirror\", p, 0, 10000000);");
code("modifyProtounitAbsolute(\"Storage Pit\", p, 0, 10000000);");
code("trUnforbidProtounit(p, \"Outpost\");");
code("modifyProtounitAbsolute(\"Outpost\", p, 16, 0);");
code("modifyProtounitAbsolute(\"Outpost\", p, 17, 100);");
code("modifyProtounitAbsolute(\"Mercenary\", p, 8, 1);");
code("modifyProtounitAbsolute(\"Farm\", p, 16, 0);");
code("modifyProtounitAbsolute(\"Farm\", p, 17, 100);");
code("modifyProtounitAbsolute(\"Farm\", p, 18, 0);");
code("modifyProtounitAbsolute(\"Tower\", p, 16, 0);");
code("modifyProtounitAbsolute(\"Tower\", p, 17, 250);");
code("modifyProtounitAbsolute(\"Tower\", p, 18, 0);");
code("modifyProtounitAbsolute(\"Tower\", p, 10, 5);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 16, 50);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 17, 0);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 18, 0);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 19, 0);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 6, 0);");
code("modifyProtounitAbsolute(\"Ape of Set\", p, 3, 1);");
code("modifyProtounitAbsolute(\"Market\", p, 16, 0);");
code("modifyProtounitAbsolute(\"Market\", p, 17, 400);");
code("modifyProtounitAbsolute(\"Market\", p, 18, 0);");
code("modifyProtounitAbsolute(\"Market\", p, 10, 1);");
code("}");
code("xsDisableSelf();");
code("}");
}
void main(void) {
rmSetStatusText("",0.01);
int MapSize = 100;
rmSetMapSize(200, 200);
rmSetSeaLevel(0);
rmSetSeaType("greek river");
rmTerrainInitialize("GrassB",3);
rmSetLightingSet("Default");
rmSwitchToTrigger(rmCreateTrigger("zenowashere"));
rmSetTriggerPriority(4);
rmSetTriggerActive(false);
rmSetTriggerLoop(false);
rmSetTriggerRunImmediately(true);
rmAddTriggerEffect("SetIdleProcessing");
rmSetTriggerEffectParam("IdleProc",");}}/*");
zshared();
voids();
globals();
terrain();
setup();
techstat();
rmAddTriggerEffect("SetIdleProcessing");
rmSetTriggerEffectParam("IdleProc",");*/rule _zenowashereagain inactive {if(true){xsDisableSelf();//");
rmSetStatusText("", 0.99);}